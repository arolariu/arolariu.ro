name: ğŸ”’ Security Vulnerability
description: Report a security vulnerability (for non-critical issues only - critical issues should be reported privately)
title: "[SECURITY] "
labels: ["security", "needs-triage"]
assignees:
  - arolariu

body:
  - type: markdown
    attributes:
      value: |
        ## âš ï¸ Security Vulnerability Report

        **IMPORTANT:** If you have discovered a critical security vulnerability that could
        potentially be exploited immediately, please DO NOT open a public issue. Instead:

        1. **Email directly**: Contact the maintainer privately
        2. **Use GitHub Security Advisories**: Create a [private security advisory](https://github.com/arolariu/arolariu.ro/security/advisories/new)
        3. **Review our Security Policy**: See [SECURITY.md](https://github.com/arolariu/arolariu.ro/blob/main/SECURITY.md)

        This public template is for security improvements and non-critical vulnerabilities
        that don't require immediate private disclosure.

  - type: checkboxes
    id: acknowledgment
    attributes:
      label: Security Acknowledgment
      description: Please confirm you understand the security reporting guidelines.
      options:
        - label: I confirm this is NOT a critical vulnerability that could be immediately exploited.
          required: true
        - label: I have read the [SECURITY.md](https://github.com/arolariu/arolariu.ro/blob/main/SECURITY.md) file.
          required: true
        - label: I understand that critical vulnerabilities should be reported privately.
          required: true

  - type: dropdown
    id: vuln-type
    attributes:
      label: Vulnerability Type
      description: What type of security issue is this?
      options:
        - ğŸ” Authentication - Login, session, or identity issues
        - ğŸ›¡ï¸ Authorization - Permission or access control issues
        - ğŸ’‰ Injection - SQL, NoSQL, command, or code injection
        - ğŸ“ XSS - Cross-site scripting vulnerabilities
        - ğŸ”„ CSRF - Cross-site request forgery
        - ğŸ“¤ Information Disclosure - Sensitive data exposure
        - âš™ï¸ Configuration - Insecure default or misconfiguration
        - ğŸ“¦ Dependency - Vulnerable dependency or package
        - ğŸ”‘ Cryptography - Weak encryption or hashing
        - ğŸŒ CORS - Cross-origin resource sharing issues
        - ğŸ“ Path Traversal - Directory traversal vulnerabilities
        - ğŸ”— Open Redirect - URL redirect vulnerabilities
        - ğŸ’¾ Data Validation - Input/output validation issues
        - ğŸš« DoS Potential - Denial of service vectors
        - ğŸ“‹ Security Headers - Missing or incorrect headers
        - ğŸ”§ Other Security Issue
    validations:
      required: true

  - type: dropdown
    id: severity
    attributes:
      label: Severity Assessment
      description: How severe do you assess this vulnerability to be?
      options:
        - ğŸŸ¡ Low - Minor security improvement, defense in depth
        - ğŸŸ  Medium - Limited impact, requires specific conditions
        - ğŸ”´ High - Significant impact, but not immediately exploitable
    validations:
      required: true

  - type: dropdown
    id: affected-area
    attributes:
      label: Affected Area
      description: Which part of the application is affected?
      multiple: true
      options:
        - Frontend (arolariu.ro)
        - Backend API (api.arolariu.ro)
        - Authentication System
        - Database Layer
        - Infrastructure
        - CI/CD Pipeline
        - Dependencies
        - Configuration
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: Vulnerability Description
      description: Describe the security issue. Be specific but avoid including exploit details.
      placeholder: |
        Describe the vulnerability and its potential impact.
        What could an attacker potentially do if this were exploited?
    validations:
      required: true

  - type: textarea
    id: reproduction
    attributes:
      label: Steps to Identify
      description: How did you discover this vulnerability?
      placeholder: |
        1. Navigate to '...'
        2. Observe that '...'
        3. This indicates '...'
    validations:
      required: true

  - type: textarea
    id: impact
    attributes:
      label: Potential Impact
      description: What is the potential impact if this vulnerability were exploited?
      placeholder: |
        - Who could be affected?
        - What data could be exposed?
        - What actions could an attacker take?
    validations:
      required: true

  - type: textarea
    id: recommendation
    attributes:
      label: Recommended Fix
      description: If you have suggestions for how to fix this, please share them.
      placeholder: |
        - Suggested code changes
        - Configuration updates
        - Best practices to implement

  - type: textarea
    id: references
    attributes:
      label: References
      description: Any relevant references, CVEs, or documentation.
      placeholder: |
        - OWASP reference: [link]
        - CVE number (if applicable)
        - Related articles or documentation

  - type: textarea
    id: additional
    attributes:
      label: Additional Context
      description: Any other context about the security issue.
      placeholder: |
        - How you discovered this
        - Tools used for testing
        - Related issues

  - type: checkboxes
    id: contribution
    attributes:
      label: Contribution
      description: Would you like to help fix this security issue?
      options:
        - label: I am willing to submit a pull request to fix this issue.
          required: false
        - label: I am available for follow-up questions.
          required: false
