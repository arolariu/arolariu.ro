# =============================================================================
# Dependabot Configuration for arolariu.ro Monorepo
# =============================================================================
# This configuration manages automated dependency updates across the monorepo,
# including npm packages, NuGet packages, GitHub Actions, and Docker images.
#
# Monorepo Structure:
#   /                        - Root (Nx, ESLint, Prettier, Vitest, Playwright)
#   /packages/components     - Shared React component library (RSLib, Storybook)
#   /sites/arolariu.ro       - Next.js 16 website (frontend)
#   /sites/api.arolariu.ro   - .NET 10 backend API (NuGet)
#   /sites/cv.arolariu.ro    - SvelteKit CV site
#   /sites/docs.arolariu.ro  - DocFX documentation (no npm)
#   /infra/containers        - Docker container definitions
#   /.github/scripts         - GitHub Actions toolkit scripts
#   /.github/workflows       - GitHub Actions workflows
#
# Schedule:
#   Sunday    - GitHub Actions
#   Monday    - Root npm dependencies
#   Tuesday   - Frontend (Next.js) + Components library
#   Wednesday - CV site (SvelteKit)
#   Thursday  - Backend (.NET/NuGet)
#   Friday    - Docker images + CI scripts
#
# Documentation:
#   https://docs.github.com/en/code-security/dependabot/dependabot-version-updates
# =============================================================================

version: 2

updates:
  # ===========================================================================
  # GITHUB ACTIONS WORKFLOWS
  # ===========================================================================
  # Keep GitHub Actions workflows up to date for security and features.
  # Scans: /.github/workflows/*.yml and /.github/actions/*/action.yml
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "sunday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "ci(actions)"
      include: "scope"
    labels:
      - "dependencies"
      - "github-actions"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 5
    groups:
      # Group all GitHub Actions minor updates together
      github-actions-all:
        patterns:
          - "*"
        update-types:
          - "minor"

  # ===========================================================================
  # ROOT NPM DEPENDENCIES
  # ===========================================================================
  # Monorepo root: Nx, ESLint, Prettier, TypeScript, Vitest, Playwright
  - package-ecosystem: "npm"
    directory: "/"
    schedule:
      interval: "weekly"
      day: "monday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(root-deps)"
      include: "scope"
    labels:
      - "dependencies"
      - "npm"
      - "monorepo-root"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 10
    versioning-strategy: increase
    groups:
      # ESLint ecosystem (20+ plugins configured)
      eslint:
        patterns:
          - "eslint"
          - "eslint-*"
          - "@eslint/*"
          - "@typescript-eslint/*"
          - "@stylistic/*"
        update-types:
          - "minor"
      # Prettier and formatting plugins
      prettier:
        patterns:
          - "prettier"
          - "prettier-*"
          - "@trivago/*"
        update-types:
          - "minor"
      # Nx monorepo tooling
      nx:
        patterns:
          - "nx"
          - "@nx/*"
        update-types:
          - "minor"
      # TypeScript and type definitions
      typescript:
        patterns:
          - "typescript"
          - "@types/*"
        update-types:
          - "minor"
      # Testing: Vitest (unit) + Playwright (E2E)
      testing:
        patterns:
          - "vitest"
          - "@vitest/*"
          - "playwright"
          - "@playwright/*"
        update-types:
          - "minor"

  # ===========================================================================
  # FRONTEND - NEXT.JS 16 WEBSITE
  # ===========================================================================
  # Main website: Next.js 16, React 19, Tailwind CSS v4, Clerk, OpenTelemetry
  - package-ecosystem: "npm"
    directory: "/sites/arolariu.ro"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(frontend)"
      include: "scope"
    labels:
      - "dependencies"
      - "npm"
      - "frontend"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 10
    versioning-strategy: increase
    groups:
      # Next.js and React core
      nextjs-react:
        patterns:
          - "next"
          - "next-*"
          - "react"
          - "react-dom"
          - "@next/*"
        update-types:
          - "minor"
      # Radix UI primitives (shadcn/ui foundation)
      radix:
        patterns:
          - "@radix-ui/*"
        update-types:
          - "minor"
      # Clerk authentication
      clerk:
        patterns:
          - "@clerk/*"
        update-types:
          - "minor"
      # Tailwind CSS v4 ecosystem
      tailwind:
        patterns:
          - "tailwindcss"
          - "@tailwindcss/*"
          - "tailwind-*"
        update-types:
          - "minor"
      # OpenTelemetry observability stack
      opentelemetry:
        patterns:
          - "@opentelemetry/*"
        update-types:
          - "minor"
      # Forms: react-hook-form + zod validation
      forms:
        patterns:
          - "react-hook-form"
          - "zod"
          - "@hookform/*"
        update-types:
          - "minor"
      # Internationalization with next-intl
      i18n:
        patterns:
          - "next-intl"
          - "@formatjs/*"
        update-types:
          - "minor"
      # Azure SDKs for storage, config, etc.
      azure-sdk:
        patterns:
          - "@azure/*"
        update-types:
          - "minor"
      # State management: Zustand
      state:
        patterns:
          - "zustand"
        update-types:
          - "minor"

  # ===========================================================================
  # SHARED COMPONENTS LIBRARY
  # ===========================================================================
  # packages/components: RSLib build, Storybook docs, shadcn/ui components
  - package-ecosystem: "npm"
    directory: "/packages/components"
    schedule:
      interval: "weekly"
      day: "tuesday"
      time: "07:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(components)"
      include: "scope"
    labels:
      - "dependencies"
      - "npm"
      - "components"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 5
    versioning-strategy: increase
    groups:
      # Storybook documentation platform
      storybook:
        patterns:
          - "storybook"
          - "@storybook/*"
          - "@chromatic-com/*"
        update-types:
          - "minor"
      # RSLib/Rsbuild build tooling
      rslib:
        patterns:
          - "@rslib/*"
          - "@rsbuild/*"
        update-types:
          - "minor"
      # UI utilities (CVA, clsx, tailwind-merge)
      ui-utils:
        patterns:
          - "@radix-ui/*"
          - "class-variance-authority"
          - "clsx"
          - "tailwind-merge"
        update-types:
          - "minor"

  # ===========================================================================
  # CV SITE - SVELTEKIT
  # ===========================================================================
  # Static CV/resume site built with SvelteKit + Azure SWA adapter
  - package-ecosystem: "npm"
    directory: "/sites/cv.arolariu.ro"
    schedule:
      interval: "weekly"
      day: "wednesday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(cv)"
      include: "scope"
    labels:
      - "dependencies"
      - "npm"
      - "cv-site"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 5
    versioning-strategy: increase
    groups:
      # SvelteKit framework and adapters
      svelte:
        patterns:
          - "svelte"
          - "@sveltejs/*"
          - "svelte-*"
        update-types:
          - "minor"

  # ===========================================================================
  # BACKEND - .NET 10 API
  # ===========================================================================
  # Modular monolith API: Microsoft, Azure SDK, OpenTelemetry, xUnit
  - package-ecosystem: "nuget"
    directory: "/sites/api.arolariu.ro"
    schedule:
      interval: "weekly"
      day: "thursday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(backend)"
      include: "scope"
    labels:
      - "dependencies"
      - "nuget"
      - "backend"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 10
    groups:
      # Microsoft.Extensions.* and System.* packages
      microsoft:
        patterns:
          - "Microsoft.*"
          - "System.*"
        update-types:
          - "minor"
      # Azure SDK for .NET
      azure:
        patterns:
          - "Azure.*"
        update-types:
          - "minor"
      # OpenTelemetry for observability
      opentelemetry:
        patterns:
          - "OpenTelemetry*"
        update-types:
          - "minor"
      # Testing: xUnit, FluentAssertions, Coverlet
      testing:
        patterns:
          - "xunit*"
          - "Moq*"
          - "FluentAssertions*"
          - "coverlet*"
        update-types:
          - "minor"

  # ===========================================================================
  # DOCKER IMAGES - INFRASTRUCTURE CONTAINERS
  # ===========================================================================
  # Container definitions in /infra/containers (backend, frontend, cv)
  - package-ecosystem: "docker"
    directory: "/infra/containers"
    schedule:
      interval: "weekly"
      day: "friday"
      time: "06:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(docker)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "infrastructure"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 3

  # ===========================================================================
  # DOCKER IMAGES - FRONTEND DOCKERFILE
  # ===========================================================================
  # Standalone Dockerfile in sites/arolariu.ro
  - package-ecosystem: "docker"
    directory: "/sites/arolariu.ro"
    schedule:
      interval: "weekly"
      day: "friday"
      time: "06:30"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(docker-frontend)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "frontend"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 2

  # ===========================================================================
  # DOCKER IMAGES - BACKEND DOCKERFILE
  # ===========================================================================
  # Standalone Dockerfile in sites/api.arolariu.ro
  - package-ecosystem: "docker"
    directory: "/sites/api.arolariu.ro"
    schedule:
      interval: "weekly"
      day: "friday"
      time: "07:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "chore(docker-backend)"
      include: "scope"
    labels:
      - "dependencies"
      - "docker"
      - "backend"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 2

  # ===========================================================================
  # GITHUB ACTIONS CI SCRIPTS
  # ===========================================================================
  # TypeScript scripts using @actions/* toolkit packages
  - package-ecosystem: "npm"
    directory: "/.github/scripts"
    schedule:
      interval: "weekly"
      day: "friday"
      time: "08:00"
      timezone: "Europe/Bucharest"
    commit-message:
      prefix: "ci(scripts)"
      include: "scope"
    labels:
      - "dependencies"
      - "npm"
      - "ci"
      - "automated"
    assignees:
      - "arolariu"
    open-pull-requests-limit: 3
    versioning-strategy: increase
    groups:
      # GitHub Actions toolkit packages
      actions-toolkit:
        patterns:
          - "@actions/*"
        update-types:
          - "minor"
      # TypeScript and testing
      dev-tools:
        patterns:
          - "typescript"
          - "@types/*"
          - "vitest"
          - "@vitest/*"
        update-types:
          - "minor"
