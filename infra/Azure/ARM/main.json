{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "languageVersion": "2.0",
  "contentVersion": "1.0.0.0",
  "metadata": {
    "_generator": {
      "name": "bicep",
      "version": "0.36.1.42791",
      "templateHash": "8850483358103990348"
    },
    "description": "This bicep file is the main entry point for any zero-touch deployment.",
    "author": "Alexandru-Razvan Olariu <admin@arolariu.ro>"
  },
  "parameters": {
    "resourceGroupName": {
      "type": "string",
      "minLength": 1,
      "maxLength": 90,
      "metadata": {
        "description": "The name of the resource group that will contain all the resources."
      }
    },
    "resourceGroupAuthor": {
      "type": "string",
      "minLength": 5,
      "maxLength": 100,
      "metadata": {
        "description": "The author of the resource group and deployment."
      }
    },
    "resourceGroupLocation": {
      "type": "string",
      "allowedValues": [
        "swedencentral",
        "norwayeast",
        "westeurope",
        "northeurope"
      ],
      "metadata": {
        "description": "The location of the resource group that will contain all the resources."
      }
    },
    "resourceDeploymentDate": {
      "type": "string",
      "defaultValue": "[utcNow()]",
      "metadata": {
        "description": "The date when the deployment is executed."
      }
    }
  },
  "resources": {
    "resourceGroup": {
      "type": "Microsoft.Resources/resourceGroups",
      "apiVersion": "2025-04-01",
      "name": "[parameters('resourceGroupName')]",
      "location": "[parameters('resourceGroupLocation')]",
      "tags": {
        "deploymentType": "Bicep",
        "deploymentAuthor": "[parameters('resourceGroupAuthor')]",
        "deploymentDate": "[parameters('resourceDeploymentDate')]"
      }
    },
    "mainDeployment": {
      "type": "Microsoft.Resources/deployments",
      "apiVersion": "2022-09-01",
      "name": "[format('mainDeployment-{0}', parameters('resourceDeploymentDate'))]",
      "resourceGroup": "[parameters('resourceGroupName')]",
      "properties": {
        "expressionEvaluationOptions": {
          "scope": "inner"
        },
        "mode": "Incremental",
        "parameters": {
          "resourceDeploymentDate": {
            "value": "[parameters('resourceDeploymentDate')]"
          },
          "resourceLocation": {
            "value": "[parameters('resourceGroupLocation')]"
          }
        },
        "template": {
          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
          "languageVersion": "2.0",
          "contentVersion": "1.0.0.0",
          "metadata": {
            "_generator": {
              "name": "bicep",
              "version": "0.36.1.42791",
              "templateHash": "17116188626519572566"
            },
            "description": "This file acts a facade that will be called by the main bicep file. This file contains all module deployments (compute, storage, identity, etc.). This file is responsible for deploying all the modules.",
            "author": "Alexandru-Razvan Olariu"
          },
          "parameters": {
            "resourceDeploymentDate": {
              "type": "string",
              "defaultValue": "[utcNow()]",
              "metadata": {
                "description": "The date when the deployment is executed."
              }
            },
            "resourceLocation": {
              "type": "string",
              "allowedValues": [
                "swedencentral",
                "norwayeast",
                "westeurope",
                "northeurope"
              ],
              "metadata": {
                "description": "The location for the resources."
              }
            }
          },
          "variables": {
            "resourceConventionPrefix": "[format('q{0}', substring(uniqueString(parameters('resourceDeploymentDate')), 0, 5))]"
          },
          "resources": {
            "identitiesDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('identitiesDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "16140128950572589964"
                    }
                  },
                  "definitions": {
                    "identity": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "displayName": {
                          "type": "string"
                        },
                        "resourceId": {
                          "type": "string"
                        },
                        "principalId": {
                          "type": "string"
                        }
                      },
                      "metadata": {
                        "type": "identity",
                        "name": "identity",
                        "__bicep_imported_from!": {
                          "sourceTemplate": "../types/identity.type.bicep"
                        }
                      }
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    }
                  },
                  "variables": {
                    "managedIdentitiesNamePrefix": "[format('{0}-uami', parameters('resourceConventionPrefix'))]"
                  },
                  "resources": {
                    "managedIdentities": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('managedIdentitiesDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "userAssignedManagedIdentityNamePrefix": {
                            "value": "[variables('managedIdentitiesNamePrefix')]"
                          },
                          "userAssignedManagedIdentityLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "userAssignedManagedIdentityDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "14778604061698189154"
                            },
                            "description": "This template will create three user assigned managed identities: Front-End, Back-End, Infrastructure",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            },
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "userAssignedManagedIdentityNamePrefix": {
                              "type": "string",
                              "metadata": {
                                "description": "The prefix for the user assigned managed identities"
                              }
                            },
                            "userAssignedManagedIdentityLocation": {
                              "type": "string",
                              "allowedValues": [
                                "swedencentral",
                                "norwayeast",
                                "westeurope",
                                "northeurope"
                              ],
                              "metadata": {
                                "description": "The location of the user assigned managed identities"
                              }
                            },
                            "userAssignedManagedIdentityDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('userAssignedManagedIdentityDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "identity",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            },
                            "identities": [
                              {
                                "name": "[format('{0}-frontend', parameters('userAssignedManagedIdentityNamePrefix'))]",
                                "location": "[parameters('userAssignedManagedIdentityLocation')]",
                                "displayName": "Frontend Identity"
                              },
                              {
                                "name": "[format('{0}-backend', parameters('userAssignedManagedIdentityNamePrefix'))]",
                                "location": "[parameters('userAssignedManagedIdentityLocation')]",
                                "displayName": "Backend Identity"
                              },
                              {
                                "name": "[format('{0}-infrastructure', parameters('userAssignedManagedIdentityNamePrefix'))]",
                                "location": "[parameters('userAssignedManagedIdentityLocation')]",
                                "displayName": "Infrastructure Identity"
                              }
                            ]
                          },
                          "resources": {
                            "userAssignedManagedIdentities": {
                              "copy": {
                                "name": "userAssignedManagedIdentities",
                                "count": "[length(variables('identities'))]"
                              },
                              "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
                              "apiVersion": "2025-01-31-preview",
                              "name": "[variables('identities')[copyIndex()].name]",
                              "location": "[variables('identities')[copyIndex()].location]",
                              "tags": "[union(variables('commonTags'), createObject('displayName', variables('identities')[copyIndex()].displayName, 'identityType', variables('identities')[copyIndex()].displayName))]"
                            }
                          },
                          "outputs": {
                            "userAssignedManagedIdentities": {
                              "type": "array",
                              "items": {
                                "$ref": "#/definitions/identity"
                              },
                              "copy": {
                                "count": "[length(range(0, length(variables('identities'))))]",
                                "input": {
                                  "name": "[variables('identities')[range(0, length(variables('identities')))[copyIndex()]].name]",
                                  "displayName": "[variables('identities')[range(0, length(variables('identities')))[copyIndex()]].displayName]",
                                  "resourceId": "[resourceId('Microsoft.ManagedIdentity/userAssignedIdentities', variables('identities')[range(0, length(variables('identities')))[copyIndex()]].name)]",
                                  "principalId": "[reference(format('userAssignedManagedIdentities[{0}]', range(0, length(variables('identities')))[copyIndex()])).principalId]"
                                }
                              }
                            }
                          }
                        }
                      }
                    },
                    "federatedCredentials": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('federatedCredentialsDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "infrastructureManagedIdentity": {
                            "value": "[reference('managedIdentities').outputs.userAssignedManagedIdentities.value[2]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "7909649868365867295"
                            },
                            "description": "This template will create both development and production federated managed identities for Azure resources.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "infrastructureManagedIdentity": {
                              "$ref": "#/definitions/identity"
                            }
                          },
                          "variables": {
                            "federatedCredentials": [
                              {
                                "name": "FederatedGithubCredentialForDevelopment",
                                "subject": "repo:arolariu/arolariu.ro:environment:development"
                              },
                              {
                                "name": "FederatedGithubCredentialForProduction",
                                "subject": "repo:arolariu/arolariu.ro:environment:production"
                              }
                            ]
                          },
                          "resources": {
                            "managedIdentity": {
                              "existing": true,
                              "type": "Microsoft.ManagedIdentity/userAssignedIdentities",
                              "apiVersion": "2025-01-31-preview",
                              "name": "[parameters('infrastructureManagedIdentity').name]"
                            },
                            "federatedCredentialsForInfrastructureIdentity": {
                              "copy": {
                                "name": "federatedCredentialsForInfrastructureIdentity",
                                "count": "[length(variables('federatedCredentials'))]",
                                "mode": "serial",
                                "batchSize": 1
                              },
                              "type": "Microsoft.ManagedIdentity/userAssignedIdentities/federatedIdentityCredentials",
                              "apiVersion": "2025-01-31-preview",
                              "name": "[format('{0}/{1}', parameters('infrastructureManagedIdentity').name, variables('federatedCredentials')[copyIndex()].name)]",
                              "properties": {
                                "issuer": "https://token.actions.githubusercontent.com",
                                "subject": "[variables('federatedCredentials')[copyIndex()].subject]",
                                "audiences": [
                                  "api://AzureADTokenExchange"
                                ]
                              }
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "managedIdentities"
                      ]
                    },
                    "securityGroups": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('securityGroupsDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.1-experimental",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "6270980026464034562"
                            },
                            "description": "This template will create security groups for specific access to resources.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "imports": {
                            "MicrosoftGraph": {
                              "provider": "MicrosoftGraph",
                              "version": "0.1.9-preview"
                            }
                          },
                          "resources": {
                            "securityGroupForUsers": {
                              "import": "MicrosoftGraph",
                              "type": "Microsoft.Graph/groups@v1.0",
                              "properties": {
                                "displayName": "arolariu-JIT-Users",
                                "mailEnabled": false,
                                "mailNickname": "arolariu-JIT-Users",
                                "securityEnabled": true,
                                "uniqueName": "arolariu-JIT-Users",
                                "description": "Security group for Just-In-Time access to resources, for users."
                              }
                            },
                            "securityGroupForApps": {
                              "import": "MicrosoftGraph",
                              "type": "Microsoft.Graph/groups@v1.0",
                              "properties": {
                                "displayName": "arolariu-JIT-Apps",
                                "mailEnabled": false,
                                "mailNickname": "arolariu-JIT-Apps",
                                "securityEnabled": true,
                                "uniqueName": "arolariu-JIT-Apps",
                                "description": "Security group for Just-In-Time access to resources, for apps."
                              }
                            }
                          }
                        }
                      }
                    }
                  },
                  "outputs": {
                    "managedIdentitiesList": {
                      "type": "array",
                      "items": {
                        "$ref": "#/definitions/identity"
                      },
                      "value": "[reference('managedIdentities').outputs.userAssignedManagedIdentities.value]"
                    }
                  }
                }
              }
            },
            "rbacDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('rbacDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "managedIdentities": {
                    "value": "[reference('identitiesDeployment').outputs.managedIdentitiesList.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "16166525840037237090"
                    },
                    "description": "RBAC module deployment file that manages resource group level role assignments for managed identities",
                    "author": "Alexandru-Razvan Olariu"
                  },
                  "definitions": {
                    "identity": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "displayName": {
                          "type": "string"
                        },
                        "resourceId": {
                          "type": "string"
                        },
                        "principalId": {
                          "type": "string"
                        }
                      },
                      "metadata": {
                        "type": "identity",
                        "name": "identity",
                        "__bicep_imported_from!": {
                          "sourceTemplate": "../types/identity.type.bicep"
                        }
                      }
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "defaultValue": "[utcNow()]",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "managedIdentities": {
                      "type": "array",
                      "items": {
                        "$ref": "#/definitions/identity"
                      },
                      "metadata": {
                        "description": "Array of managed identities that need RBAC assignments"
                      }
                    }
                  },
                  "resources": {
                    "frontendUamiRbac": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('frontendUamiRbac-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "frontendIdentity": {
                            "value": "[parameters('managedIdentities')[0]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "3883623476873467314"
                            },
                            "description": "RBAC role assignments for the frontend managed identity.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "frontendIdentity": {
                              "$ref": "#/definitions/identity",
                              "metadata": {
                                "description": "Role definitions for frontend managed identities"
                              }
                            }
                          },
                          "variables": {
                            "roleDefinitions": {
                              "storageBlobReader": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                              "storageQueueReader": "19e7f393-937e-4f77-808e-94535e297925",
                              "storageTableReader": "76199698-9eea-4c19-bc75-cec21354c6b6",
                              "appConfigReader": "516239f1-63e1-4d78-a4de-a74fb236a071"
                            }
                          },
                          "resources": {
                            "frontendStorageBlobReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('frontendIdentity').principalId, variables('roleDefinitions').storageBlobReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageBlobReader)]",
                                "principalId": "[parameters('frontendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Frontend managed identity access to storage blob data (read-only)"
                              }
                            },
                            "frontendStorageQueueReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('frontendIdentity').principalId, variables('roleDefinitions').storageQueueReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageQueueReader)]",
                                "principalId": "[parameters('frontendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Frontend managed identity access to storage queue data (read-only)"
                              }
                            },
                            "frontendStorageTableReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('frontendIdentity').principalId, variables('roleDefinitions').storageTableReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageTableReader)]",
                                "principalId": "[parameters('frontendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Frontend managed identity access to storage table data (read-only)"
                              }
                            },
                            "frontendAppConfigReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('frontendIdentity').principalId, variables('roleDefinitions').appConfigReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').appConfigReader)]",
                                "principalId": "[parameters('frontendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Frontend managed identity access to App Configuration data (read-only)"
                              }
                            }
                          }
                        }
                      }
                    },
                    "backendUamiRbac": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('backendUamiRbac-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "backendIdentity": {
                            "value": "[parameters('managedIdentities')[1]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "4065317330951314592"
                            },
                            "description": "RBAC role assignments for the backend managed identity.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "backendIdentity": {
                              "$ref": "#/definitions/identity",
                              "metadata": {
                                "description": "Role definitions for backend managed identities"
                              }
                            }
                          },
                          "variables": {
                            "roleDefinitions": {
                              "storageBlobContributor": "ba92f5b4-2d11-453d-a403-e96b0029c9fe",
                              "storageQueueContributor": "974c5e8b-45b9-4653-ba55-5f855dd0fb88",
                              "storageTableContributor": "0a9a7e1f-b9d0-4cc4-a60d-0319b160aaa3",
                              "sqlDbContributor": "9b7fa17d-e63e-47b0-bb0a-15c516ac86ec",
                              "appConfigContributor": "fe86443c-f201-4fc4-9d2a-ac61149fbda0",
                              "openAiContributor": "a001fd3d-188f-4b5d-821b-7da978bf7442",
                              "keyVaultContributor": "f25e0fa2-a7c8-4377-a976-54943a77a395",
                              "keyVaultSecretsContributor": "b86a8fe4-44ce-4948-aee5-eccb2c155cd7"
                            }
                          },
                          "resources": {
                            "backendStorageBlobContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').storageBlobContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageBlobContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to storage blob data (read-write)"
                              }
                            },
                            "backendStorageQueueContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').storageQueueContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageQueueContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to storage queue data (read-write)"
                              }
                            },
                            "backendStorageTableContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').storageTableContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageTableContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to storage table data (read-write)"
                              }
                            },
                            "backendSqlDbContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').sqlDbContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').sqlDbContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to SQL Database management"
                              }
                            },
                            "backendAppConfigContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').appConfigContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').appConfigContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to App Configuration management"
                              }
                            },
                            "backendOpenAiContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').openAiContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').openAiContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to OpenAI management"
                              }
                            },
                            "backendKeyVaultContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').keyVaultContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').keyVaultContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to Key Vault management"
                              }
                            },
                            "backendKeyVaultSecretsContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('backendIdentity').principalId, variables('roleDefinitions').keyVaultSecretsContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').keyVaultSecretsContributor)]",
                                "principalId": "[parameters('backendIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Backend managed identity access to Key Vault secrets management"
                              }
                            }
                          }
                        }
                      }
                    },
                    "infrastructureUamiRbac": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('infrastructureUamiRbac-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "infrastructureIdentity": {
                            "value": "[parameters('managedIdentities')[2]]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "7936975750483813583"
                            },
                            "description": "RBAC role assignments for the infrastructure managed identity.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "infrastructureIdentity": {
                              "$ref": "#/definitions/identity",
                              "metadata": {
                                "description": "Role definitions for infrastructure managed identities"
                              }
                            }
                          },
                          "variables": {
                            "roleDefinitions": {
                              "storageBlobReader": "2a2b9908-6ea1-4ae2-8e65-a410df84e7d1",
                              "storageQueueReader": "19e7f393-937e-4f77-808e-94535e297925",
                              "storageTableReader": "76199698-9eea-4c19-bc75-cec21354c6b6",
                              "appConfigReader": "516239f1-63e1-4d78-a4de-a74fb236a071",
                              "keyVaultReader": "21090545-7ca7-4776-b22c-e363652d74d2",
                              "keyVaultSecretsReader": "4633458b-17de-408a-b874-0445c86b69e6",
                              "acrPull": "7f951dda-4ed3-4680-a7ca-43fe172d538d",
                              "acrPush": "8311e382-0749-4cb8-b61a-304f252e45ec",
                              "acrContributor": "2efddaa5-3f1f-4df3-97df-af3f13818f4c",
                              "websiteContributor": "de139f84-1756-47ae-9be6-808fbbe84772"
                            }
                          },
                          "resources": {
                            "infrastructureStorageBlobReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').storageBlobReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageBlobReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to storage blob data (read-only)"
                              }
                            },
                            "infrastructureStorageQueueReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').storageQueueReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageQueueReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to storage queue data (read-only)"
                              }
                            },
                            "infrastructureStorageTableReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').storageTableReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').storageTableReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to storage table data (read-only)"
                              }
                            },
                            "infrastructureAppConfigReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').appConfigReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').appConfigReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to App Configuration data (read-only)"
                              }
                            },
                            "infrastructureKeyVaultReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').keyVaultReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').keyVaultReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Key Vault (read-only)"
                              }
                            },
                            "infrastructureKeyVaultSecretsReaderRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').keyVaultSecretsReader)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').keyVaultSecretsReader)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Key Vault secrets (read-only)"
                              }
                            },
                            "infrastructureAcrPullRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').acrPull)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').acrPull)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Azure Container Registry (pull)"
                              }
                            },
                            "infrastructureAcrPushRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').acrPush)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').acrPush)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Azure Container Registry (push)"
                              }
                            },
                            "infrastructureAcrContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').acrContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').acrContributor)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Azure Container Registry management"
                              }
                            },
                            "infrastructureWebsiteContributorRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "name": "[guid(resourceGroup().id, parameters('infrastructureIdentity').principalId, variables('roleDefinitions').websiteContributor)]",
                              "properties": {
                                "roleDefinitionId": "[subscriptionResourceId('Microsoft.Authorization/roleDefinitions', variables('roleDefinitions').websiteContributor)]",
                                "principalId": "[parameters('infrastructureIdentity').principalId]",
                                "principalType": "ServicePrincipal",
                                "description": "Infrastructure managed identity access to Azure Website management"
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "dependsOn": [
                "identitiesDeployment"
              ]
            },
            "configurationDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('configurationDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  },
                  "identities": {
                    "value": "[reference('identitiesDeployment').outputs.managedIdentitiesList.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "16748279876410481668"
                    }
                  },
                  "definitions": {
                    "identity": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string"
                        },
                        "displayName": {
                          "type": "string"
                        },
                        "resourceId": {
                          "type": "string"
                        },
                        "principalId": {
                          "type": "string"
                        }
                      },
                      "metadata": {
                        "type": "identity",
                        "name": "identity",
                        "__bicep_imported_from!": {
                          "sourceTemplate": "../types/identity.type.bicep"
                        }
                      }
                    }
                  },
                  "parameters": {
                    "identities": {
                      "type": "array",
                      "items": {
                        "$ref": "#/definitions/identity"
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the App Configuration resource."
                      }
                    },
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    }
                  },
                  "variables": {
                    "keyVaultName": "[format('{0}kv', replace(parameters('resourceConventionPrefix'), '-', ''))]",
                    "appConfigurationName": "[format('{0}appconfig', replace(parameters('resourceConventionPrefix'), '-', ''))]"
                  },
                  "resources": {
                    "keyVaultDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('keyVaultDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "identities": {
                            "value": "[parameters('identities')]"
                          },
                          "keyVaultName": {
                            "value": "[variables('keyVaultName')]"
                          },
                          "keyVaultLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "keyVaultDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "1670033049747318868"
                            },
                            "description": "This template will create the necessary Azure Key Vault resources for arolariu.ro",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "identity": {
                              "type": "object",
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "displayName": {
                                  "type": "string"
                                },
                                "resourceId": {
                                  "type": "string"
                                },
                                "principalId": {
                                  "type": "string"
                                }
                              },
                              "metadata": {
                                "type": "identity",
                                "name": "identity",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/identity.type.bicep"
                                }
                              }
                            },
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "identities": {
                              "type": "array",
                              "items": {
                                "$ref": "#/definitions/identity"
                              }
                            },
                            "keyVaultName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the Azure Key Vault resource."
                              }
                            },
                            "keyVaultLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the Azure Key Vault resource."
                              }
                            },
                            "keyVaultDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('keyVaultDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "configuration-keyvault",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            },
                            "keyVaultSecretNames": [
                              "app-config-store",
                              "api-jwt-secret",
                              "sql-admin-username",
                              "sql-admin-password"
                            ]
                          },
                          "resources": {
                            "keyVault::keyVaultItems": {
                              "copy": {
                                "name": "keyVault::keyVaultItems",
                                "count": "[length(variables('keyVaultSecretNames'))]"
                              },
                              "type": "Microsoft.KeyVault/vaults/secrets",
                              "apiVersion": "2024-12-01-preview",
                              "name": "[format('{0}/{1}', parameters('keyVaultName'), variables('keyVaultSecretNames')[copyIndex()])]",
                              "properties": {
                                "attributes": {
                                  "enabled": true
                                },
                                "value": ""
                              },
                              "dependsOn": [
                                "keyVault"
                              ]
                            },
                            "keyVault": {
                              "type": "Microsoft.KeyVault/vaults",
                              "apiVersion": "2024-04-01-preview",
                              "name": "[parameters('keyVaultName')]",
                              "location": "[parameters('keyVaultLocation')]",
                              "properties": {
                                "enabledForDeployment": false,
                                "enabledForDiskEncryption": false,
                                "enabledForTemplateDeployment": true,
                                "enablePurgeProtection": true,
                                "enableRbacAuthorization": true,
                                "enableSoftDelete": true,
                                "networkAcls": {},
                                "publicNetworkAccess": "enabled",
                                "sku": {
                                  "family": "A",
                                  "name": "standard"
                                },
                                "softDeleteRetentionInDays": 90,
                                "tenantId": "[subscription().tenantId]",
                                "vaultUri": "[format('https://{0}{1}', parameters('keyVaultName'), environment().suffixes.keyvaultDns)]"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Key Vault', 'resourceType', 'Key Vault'))]"
                            }
                          },
                          "outputs": {
                            "mainKeyVaultUri": {
                              "type": "string",
                              "value": "[reference('keyVault').vaultUri]"
                            },
                            "mainKeyVaultResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.KeyVault/vaults', parameters('keyVaultName'))]"
                            },
                            "mainKeyVaultName": {
                              "type": "string",
                              "value": "[parameters('keyVaultName')]"
                            }
                          }
                        }
                      }
                    },
                    "appConfigurationDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('appConfigurationDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "appConfigurationName": {
                            "value": "[variables('appConfigurationName')]"
                          },
                          "appConfigurationLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "appConfigurationDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "6214355212438931331"
                            },
                            "description": "This template will deploy an Azure App Configuration resource running on the free SKU.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "appConfigurationName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the App Configuration resource."
                              }
                            },
                            "appConfigurationLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the App Configuration resource."
                              }
                            },
                            "appConfigurationDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "$fxv#0": {
                              "items": [
                                {
                                  "key": "Options:Site:Environment",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Site:Environment",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Site:Name",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Site:Name",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Site:Url",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Site:Url",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Environment",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Environment",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Name",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Name",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Url",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Api:Url",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Audience",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Audience",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Subject",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Subject",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Issuer",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Issuer",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Secret",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:Secret",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:ClerkPublishableKey",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:ClerkPublishableKey",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:ClerkSecretKey",
                                  "value": "",
                                  "label": "PRODUCTION",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Auth:ClerkSecretKey",
                                  "value": "",
                                  "label": "DEVELOPMENT",
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Azure:TenantId",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Azure:SubscriptionId",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Azure:FrontendIdentityClientId",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Azure:BackendIdentityClientId",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Azure:InfrastructureIdentityClientId",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Endpoints:CognitiveServices",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Endpoints:KeyVault",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Endpoints:OpenAI",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Endpoints:StorageAccount",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Endpoints:ApplicationInsights",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                },
                                {
                                  "key": "Options:Common:ApplicationAuthor",
                                  "value": "",
                                  "label": null,
                                  "content_type": "",
                                  "tags": {}
                                }
                              ]
                            },
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('appConfigurationDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "configuration-keyvault",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            },
                            "configs": "[variables('$fxv#0')]"
                          },
                          "resources": {
                            "appConfiguration": {
                              "type": "Microsoft.AppConfiguration/configurationStores",
                              "apiVersion": "2024-06-15-preview",
                              "name": "[parameters('appConfigurationName')]",
                              "location": "[parameters('appConfigurationLocation')]",
                              "sku": {
                                "name": "free"
                              },
                              "properties": {
                                "encryption": {},
                                "disableLocalAuth": true,
                                "softDeleteRetentionInDays": 0,
                                "enablePurgeProtection": false,
                                "publicNetworkAccess": "Enabled",
                                "dataPlaneProxy": {
                                  "authenticationMode": "Pass-through",
                                  "privateLinkDelegation": "Disabled"
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'App Configuration', 'resourceType', 'Configuration Store'))]"
                            },
                            "appConfigurationKeyValues": {
                              "copy": {
                                "name": "appConfigurationKeyValues",
                                "count": "[length(variables('configs').items)]"
                              },
                              "type": "Microsoft.AppConfiguration/configurationStores/keyValues",
                              "apiVersion": "2024-06-15-preview",
                              "name": "[format('{0}/{1}', parameters('appConfigurationName'), variables('configs').items[copyIndex()].key)]",
                              "properties": {
                                "value": "[variables('configs').items[copyIndex()].value]",
                                "tags": {
                                  "label": "[variables('configs').items[copyIndex()].label]"
                                }
                              },
                              "dependsOn": [
                                "appConfiguration"
                              ]
                            }
                          },
                          "outputs": {
                            "appConfigurationResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.AppConfiguration/configurationStores', parameters('appConfigurationName'))]"
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "dependsOn": [
                "identitiesDeployment"
              ]
            },
            "observabilityDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('observabilityDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "2025237103408419776"
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    }
                  },
                  "resources": {
                    "logAnalyticsWorkspaceDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('logAnalyticsWorkspaceDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "logAnalyticsWorkspaceLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "logAnalyticsWorkspaceDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "logAnalyticsWorkspaceName": {
                            "value": "[format('{0}-workspace', parameters('resourceConventionPrefix'))]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "1427207388924242904"
                            },
                            "description": "This template will deploy a log analytics workspace that is used for Open Telemetry (OTel) data collection.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "logAnalyticsWorkspaceName": {
                              "type": "string"
                            },
                            "logAnalyticsWorkspaceLocation": {
                              "type": "string"
                            },
                            "logAnalyticsWorkspaceDeploymentDate": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('logAnalyticsWorkspaceDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "observability",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "logAnalyticsWorkspace": {
                              "type": "Microsoft.OperationalInsights/workspaces",
                              "apiVersion": "2025-02-01",
                              "name": "[parameters('logAnalyticsWorkspaceName')]",
                              "location": "[parameters('logAnalyticsWorkspaceLocation')]",
                              "properties": {
                                "sku": {
                                  "name": "PerGB2018"
                                },
                                "retentionInDays": 30,
                                "publicNetworkAccessForIngestion": "Enabled",
                                "publicNetworkAccessForQuery": "Enabled",
                                "workspaceCapping": {
                                  "dailyQuotaGb": "[json('3')]"
                                },
                                "features": {
                                  "enableLogAccessUsingOnlyResourcePermissions": true
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Log Analytics Workspace'))]"
                            }
                          },
                          "outputs": {
                            "logAnalyticsWorkspaceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.OperationalInsights/workspaces', parameters('logAnalyticsWorkspaceName'))]"
                            }
                          }
                        }
                      }
                    },
                    "applicationInsightsDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('applicationInsightsDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "applicationInsightsName": {
                            "value": "[format('{0}-insights', parameters('resourceConventionPrefix'))]"
                          },
                          "applicationInsightsLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "applicationInsightsDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "applicationInsightsWorkspaceId": {
                            "value": "[reference('logAnalyticsWorkspaceDeployment').outputs.logAnalyticsWorkspaceId.value]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "421209488574668634"
                            },
                            "description": "This template will deploy an application insights resource that is connected to the api.arolariu.ro platform (back-end) and the arolariu.ro platform (front-end).",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "applicationInsightsName": {
                              "type": "string"
                            },
                            "applicationInsightsLocation": {
                              "type": "string"
                            },
                            "applicationInsightsWorkspaceId": {
                              "type": "string"
                            },
                            "applicationInsightsDeploymentDate": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('applicationInsightsDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "observability",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "applicationInsights": {
                              "type": "Microsoft.Insights/components",
                              "apiVersion": "2020-02-02",
                              "name": "[parameters('applicationInsightsName')]",
                              "location": "[parameters('applicationInsightsLocation')]",
                              "kind": "web",
                              "properties": {
                                "Application_Type": "web",
                                "Flow_Type": "Bluefield",
                                "Request_Source": "rest",
                                "RetentionInDays": 90,
                                "WorkspaceResourceId": "[parameters('applicationInsightsWorkspaceId')]",
                                "IngestionMode": "LogAnalytics",
                                "publicNetworkAccessForIngestion": "Enabled",
                                "publicNetworkAccessForQuery": "Enabled",
                                "SamplingPercentage": 30
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Application Insights'))]"
                            }
                          },
                          "outputs": {
                            "applicationInsightsConnectionString": {
                              "type": "string",
                              "value": "[reference('applicationInsights').ConnectionString]"
                            },
                            "applicationInsightsInstrumentationKey": {
                              "type": "string",
                              "value": "[reference('applicationInsights').InstrumentationKey]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "logAnalyticsWorkspaceDeployment"
                      ]
                    },
                    "managedGrafanaDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('managedGrafanaDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "managedGrafanaName": {
                            "value": "[format('{0}-grafana', parameters('resourceConventionPrefix'))]"
                          },
                          "managedGrafanaLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "managedGrafanaDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "7128157432900345185"
                            },
                            "description": "This template will deploy an Azure Managed Grafana instance.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "managedGrafanaLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location where the Managed Grafana instance will be deployed."
                              }
                            },
                            "managedGrafanaName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the Managed Grafana instance to be created."
                              }
                            },
                            "managedGrafanaDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the Managed Grafana instance is being deployed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('managedGrafanaDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "observability",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "managedGrafanaInstance": {
                              "type": "Microsoft.Dashboard/grafana",
                              "apiVersion": "2024-11-01-preview",
                              "name": "[parameters('managedGrafanaName')]",
                              "location": "[parameters('managedGrafanaLocation')]",
                              "sku": {
                                "name": "Essential"
                              },
                              "properties": {
                                "grafanaMajorVersion": "11",
                                "zoneRedundancy": "Disabled",
                                "publicNetworkAccess": "Enabled",
                                "apiKey": "Enabled",
                                "autoGeneratedDomainNameLabelScope": "TenantReuse",
                                "deterministicOutboundIP": "Disabled",
                                "grafanaConfigurations": {
                                  "smtp": {
                                    "enabled": false
                                  }
                                },
                                "grafanaIntegrations": {
                                  "azureMonitorWorkspaceIntegrations": []
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Managed Grafana Instance'))]"
                            }
                          },
                          "outputs": {
                            "managedGrafanaInstanceName": {
                              "type": "string",
                              "value": "[parameters('managedGrafanaName')]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "applicationInsightsDeployment",
                        "logAnalyticsWorkspaceDeployment"
                      ]
                    }
                  },
                  "outputs": {
                    "logAnalyticsWorkspaceId": {
                      "type": "string",
                      "value": "[reference('logAnalyticsWorkspaceDeployment').outputs.logAnalyticsWorkspaceId.value]"
                    },
                    "appInsightsConnectionString": {
                      "type": "string",
                      "value": "[reference('applicationInsightsDeployment').outputs.applicationInsightsConnectionString.value]"
                    },
                    "appInsightsInstrumentationKey": {
                      "type": "string",
                      "value": "[reference('applicationInsightsDeployment').outputs.applicationInsightsInstrumentationKey.value]"
                    }
                  }
                }
              },
              "dependsOn": [
                "configurationDeployment",
                "identitiesDeployment"
              ]
            },
            "storageDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('storageDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "8337380004183699871"
                    },
                    "description": "Storage module deployment file that provisions storage accounts, container registry, and databases with enterprise security standards.",
                    "author": "Alexandru-Razvan Olariu"
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "minLength": 3,
                      "maxLength": 20,
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    }
                  },
                  "variables": {
                    "storageAccountName": "[format('{0}sacc', replace(parameters('resourceConventionPrefix'), '-', ''))]",
                    "containerRegistryName": "[format('{0}acrprod', replace(parameters('resourceConventionPrefix'), '-', ''))]",
                    "sqlServerName": "[format('{0}-sqlserver', parameters('resourceConventionPrefix'))]",
                    "noSqlServerName": "[format('{0}-nosqlserver', parameters('resourceConventionPrefix'))]"
                  },
                  "resources": {
                    "storageAccountDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('storageAccountDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "storageAccountName": {
                            "value": "[variables('storageAccountName')]"
                          },
                          "storageAccountLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "storageAccountDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "10471344283634196439"
                            },
                            "description": "This template creates a secure storage account with enterprise-grade security standards.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "storageAccountName": {
                              "type": "string",
                              "minLength": 3,
                              "maxLength": 24,
                              "metadata": {
                                "description": "The storage account name."
                              }
                            },
                            "storageAccountLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the storage account resource."
                              }
                            },
                            "storageAccountDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('storageAccountDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "storage",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "storageAccount::blobServices": {
                              "type": "Microsoft.Storage/storageAccounts/blobServices",
                              "apiVersion": "2023-05-01",
                              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
                              "properties": {
                                "changeFeed": {
                                  "enabled": true,
                                  "retentionInDays": 90
                                },
                                "restorePolicy": {
                                  "enabled": true,
                                  "days": 30
                                },
                                "containerDeleteRetentionPolicy": {
                                  "enabled": true,
                                  "days": 7
                                },
                                "cors": {
                                  "corsRules": [
                                    {
                                      "allowedOrigins": [
                                        "https://arolariu.ro",
                                        "https://dev.arolariu.ro"
                                      ],
                                      "allowedMethods": [
                                        "GET",
                                        "POST",
                                        "PUT",
                                        "DELETE",
                                        "HEAD",
                                        "OPTIONS"
                                      ],
                                      "allowedHeaders": [
                                        "*"
                                      ],
                                      "exposedHeaders": [
                                        "*"
                                      ],
                                      "maxAgeInSeconds": 3600
                                    },
                                    {
                                      "allowedOrigins": [
                                        "http://localhost:3000",
                                        "http://localhost:3001"
                                      ],
                                      "allowedMethods": [
                                        "GET",
                                        "POST",
                                        "PUT",
                                        "DELETE"
                                      ],
                                      "allowedHeaders": [
                                        "*"
                                      ],
                                      "exposedHeaders": [
                                        "*"
                                      ],
                                      "maxAgeInSeconds": 1800
                                    }
                                  ]
                                },
                                "deleteRetentionPolicy": {
                                  "enabled": true,
                                  "days": 90,
                                  "allowPermanentDelete": false
                                },
                                "isVersioningEnabled": true,
                                "lastAccessTimeTrackingPolicy": {
                                  "enable": true,
                                  "name": "AccessTimeTracking",
                                  "trackingGranularityInDays": 1,
                                  "blobType": [
                                    "blockBlob"
                                  ]
                                }
                              },
                              "dependsOn": [
                                "storageAccount"
                              ]
                            },
                            "storageAccount::fileServices": {
                              "type": "Microsoft.Storage/storageAccounts/fileServices",
                              "apiVersion": "2023-05-01",
                              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
                              "properties": {
                                "shareDeleteRetentionPolicy": {
                                  "enabled": true,
                                  "days": 7,
                                  "allowPermanentDelete": false
                                },
                                "protocolSettings": {
                                  "smb": {
                                    "versions": "SMB3.0;SMB3.1.1",
                                    "authenticationMethods": "Kerberos",
                                    "kerberosTicketEncryption": "AES-256",
                                    "channelEncryption": "AES-128-CCM;AES-128-GCM;AES-256-GCM"
                                  }
                                }
                              },
                              "dependsOn": [
                                "storageAccount"
                              ]
                            },
                            "storageAccount::queueServices": {
                              "type": "Microsoft.Storage/storageAccounts/queueServices",
                              "apiVersion": "2023-05-01",
                              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
                              "properties": {},
                              "dependsOn": [
                                "storageAccount"
                              ]
                            },
                            "storageAccount::tableServices": {
                              "type": "Microsoft.Storage/storageAccounts/tableServices",
                              "apiVersion": "2023-05-01",
                              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
                              "properties": {},
                              "dependsOn": [
                                "storageAccount"
                              ]
                            },
                            "storageAccount": {
                              "type": "Microsoft.Storage/storageAccounts",
                              "apiVersion": "2023-05-01",
                              "name": "[parameters('storageAccountName')]",
                              "location": "[parameters('storageAccountLocation')]",
                              "sku": {
                                "name": "Standard_LRS"
                              },
                              "kind": "StorageV2",
                              "properties": {
                                "dnsEndpointType": "Standard",
                                "defaultToOAuthAuthentication": true,
                                "publicNetworkAccess": "Enabled",
                                "allowCrossTenantReplication": false,
                                "minimumTlsVersion": "TLS1_2",
                                "allowBlobPublicAccess": true,
                                "allowSharedKeyAccess": true,
                                "networkAcls": {
                                  "bypass": "AzureServices, Logging, Metrics",
                                  "defaultAction": "Allow"
                                },
                                "supportsHttpsTrafficOnly": true,
                                "encryption": {
                                  "keySource": "Microsoft.Storage",
                                  "requireInfrastructureEncryption": true,
                                  "services": {
                                    "blob": {
                                      "enabled": true,
                                      "keyType": "Account"
                                    },
                                    "file": {
                                      "enabled": true,
                                      "keyType": "Account"
                                    },
                                    "queue": {
                                      "enabled": true,
                                      "keyType": "Account"
                                    },
                                    "table": {
                                      "enabled": true,
                                      "keyType": "Account"
                                    }
                                  }
                                },
                                "accessTier": "Hot"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Secure Storage Account'))]"
                            },
                            "lifecyclePolicy": {
                              "type": "Microsoft.Storage/storageAccounts/managementPolicies",
                              "apiVersion": "2023-05-01",
                              "name": "[format('{0}/{1}', parameters('storageAccountName'), 'default')]",
                              "properties": {
                                "policy": {
                                  "rules": [
                                    {
                                      "enabled": true,
                                      "name": "MoveToIA",
                                      "type": "Lifecycle",
                                      "definition": {
                                        "filters": {
                                          "blobTypes": [
                                            "blockBlob"
                                          ]
                                        },
                                        "actions": {
                                          "baseBlob": {
                                            "tierToCool": {
                                              "daysAfterModificationGreaterThan": 30
                                            },
                                            "tierToArchive": {
                                              "daysAfterModificationGreaterThan": 90
                                            },
                                            "delete": {
                                              "daysAfterModificationGreaterThan": 365
                                            }
                                          },
                                          "snapshot": {
                                            "delete": {
                                              "daysAfterCreationGreaterThan": 90
                                            }
                                          },
                                          "version": {
                                            "delete": {
                                              "daysAfterCreationGreaterThan": 365
                                            }
                                          }
                                        }
                                      }
                                    }
                                  ]
                                }
                              },
                              "dependsOn": [
                                "storageAccount"
                              ]
                            }
                          },
                          "outputs": {
                            "storageAccountName": {
                              "type": "string",
                              "value": "[parameters('storageAccountName')]"
                            },
                            "storageAccountId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
                            },
                            "storageAccountBlobEndpoint": {
                              "type": "string",
                              "value": "[reference('storageAccount').primaryEndpoints.blob]"
                            },
                            "storageAccountFileEndpoint": {
                              "type": "string",
                              "value": "[reference('storageAccount').primaryEndpoints.file]"
                            },
                            "storageAccountQueueEndpoint": {
                              "type": "string",
                              "value": "[reference('storageAccount').primaryEndpoints.queue]"
                            },
                            "storageAccountTableEndpoint": {
                              "type": "string",
                              "value": "[reference('storageAccount').primaryEndpoints.table]"
                            }
                          }
                        }
                      }
                    },
                    "containerRegistryDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('containerRegistryDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "containerRegistryLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "containerRegistryName": {
                            "value": "[variables('containerRegistryName')]"
                          },
                          "containerRegistryDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "16453502393125846602"
                            },
                            "description": "This template deploys Azure Container Registry with enterprise-grade security and governance features.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "containerRegistryName": {
                              "type": "string",
                              "minLength": 5,
                              "maxLength": 50,
                              "metadata": {
                                "description": "The name of the Azure Container Registry."
                              }
                            },
                            "containerRegistryLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the Azure Container Registry resource."
                              }
                            },
                            "containerRegistryDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('containerRegistryDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "storage",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "containerRegistry": {
                              "type": "Microsoft.ContainerRegistry/registries",
                              "apiVersion": "2025-04-01",
                              "name": "[parameters('containerRegistryName')]",
                              "location": "[parameters('containerRegistryLocation')]",
                              "sku": {
                                "name": "Basic"
                              },
                              "properties": {
                                "adminUserEnabled": true,
                                "policies": {
                                  "quarantinePolicy": {
                                    "status": "Disabled"
                                  },
                                  "trustPolicy": {
                                    "status": "Disabled"
                                  },
                                  "retentionPolicy": {
                                    "status": "Disabled"
                                  },
                                  "exportPolicy": {
                                    "status": "Enabled"
                                  },
                                  "azureADAuthenticationAsArmPolicy": {
                                    "status": "Enabled"
                                  }
                                },
                                "encryption": {
                                  "status": "Disabled"
                                },
                                "dataEndpointEnabled": false,
                                "publicNetworkAccess": "Enabled",
                                "networkRuleBypassOptions": "AzureServices",
                                "zoneRedundancy": "Disabled",
                                "anonymousPullEnabled": false
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Container Registry'))]"
                            }
                          },
                          "outputs": {
                            "containerRegistryName": {
                              "type": "string",
                              "value": "[parameters('containerRegistryName')]"
                            },
                            "containerRegistryId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.ContainerRegistry/registries', parameters('containerRegistryName'))]"
                            },
                            "containerRegistryLoginServer": {
                              "type": "string",
                              "value": "[reference('containerRegistry').loginServer]"
                            },
                            "containerRegistryResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.ContainerRegistry/registries', parameters('containerRegistryName'))]"
                            }
                          }
                        }
                      }
                    },
                    "sqlServerDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('sqlServerDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "sqlServerName": {
                            "value": "[variables('sqlServerName')]"
                          },
                          "sqlServerLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "sqlServerDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "sqlServerAdministratorPassword": {
                            "value": "TempP@ssw0rd123!"
                          },
                          "sqlServerAdministratorUserName": {
                            "value": "sqladmin"
                          },
                          "sqlDatabaseNamePrefix": {
                            "value": "[format('{0}-sqlserver-db', parameters('resourceConventionPrefix'))]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "3563707032661726225"
                            },
                            "description": "This template will create a new Azure SQL server resource with standardized metadata.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "sqlServerName": {
                              "type": "string",
                              "minLength": 1,
                              "maxLength": 63,
                              "metadata": {
                                "description": "The SQL Server name."
                              }
                            },
                            "sqlServerLocation": {
                              "type": "string",
                              "allowedValues": [
                                "swedencentral",
                                "norwayeast",
                                "westeurope",
                                "northeurope"
                              ],
                              "metadata": {
                                "description": "The location for the SQL Server resource."
                              }
                            },
                            "sqlServerAdministratorUserName": {
                              "type": "securestring",
                              "metadata": {
                                "description": "The username for the local SQL Server administrator."
                              }
                            },
                            "sqlServerAdministratorPassword": {
                              "type": "securestring",
                              "metadata": {
                                "description": "The password for the local SQL Server administrator."
                              }
                            },
                            "sqlServerDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            },
                            "sqlDatabaseNamePrefix": {
                              "type": "string",
                              "metadata": {
                                "description": "The prefix for the SQL Database names."
                              }
                            }
                          },
                          "variables": {
                            "sqlDatabasePrimaryName": "[format('{0}-primary', parameters('sqlDatabaseNamePrefix'))]",
                            "sqlDatabaseSecondaryName": "[format('{0}-secondary', parameters('sqlDatabaseNamePrefix'))]",
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('sqlServerDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "storage",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "sqlServer::sqlServerAdvancedThreatProtection": {
                              "type": "Microsoft.Sql/servers/advancedThreatProtectionSettings",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), 'Default')]",
                              "properties": {
                                "state": "Disabled"
                              },
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlServer::sqlServerAuditPolicy": {
                              "type": "Microsoft.Sql/servers/auditingPolicies",
                              "apiVersion": "2014-04-01",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), 'Default')]",
                              "properties": {
                                "auditingState": "Disabled"
                              },
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlServer::sqlServerAuditSettings": {
                              "type": "Microsoft.Sql/servers/auditingSettings",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), 'default')]",
                              "properties": {
                                "state": "Disabled"
                              },
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlServer::sqlServerConnectionPolicies": {
                              "type": "Microsoft.Sql/servers/connectionPolicies",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), 'Default')]",
                              "properties": {
                                "connectionType": "Default"
                              },
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlServer::sqlServerAzureAdOnlyAuth": {
                              "type": "Microsoft.Sql/servers/azureADOnlyAuthentications",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), 'Default')]",
                              "properties": {
                                "azureADOnlyAuthentication": false
                              },
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlServer": {
                              "type": "Microsoft.Sql/servers",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[parameters('sqlServerName')]",
                              "location": "[parameters('sqlServerLocation')]",
                              "properties": {
                                "minimalTlsVersion": "1.2",
                                "publicNetworkAccess": "Enabled",
                                "version": "12.0",
                                "administratorLogin": "[parameters('sqlServerAdministratorUserName')]",
                                "administratorLoginPassword": "[parameters('sqlServerAdministratorPassword')]",
                                "administrators": {
                                  "administratorType": "ActiveDirectory",
                                  "login": "admin@arolariu.ro",
                                  "sid": "ee9acc3d-8a79-489d-b4bf-aaae428b29db",
                                  "tenantId": "[subscription().tenantId]"
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'SQL Server'))]"
                            },
                            "sqlDatabasePrimary": {
                              "type": "Microsoft.Sql/servers/databases",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), variables('sqlDatabasePrimaryName'))]",
                              "location": "[parameters('sqlServerLocation')]",
                              "sku": {
                                "name": "Standard",
                                "tier": "Standard",
                                "capacity": 10
                              },
                              "properties": {
                                "catalogCollation": "SQL_Latin1_General_CP1_CI_AS",
                                "collation": "SQL_Latin1_General_CP1_CI_AS",
                                "maxSizeBytes": 268435456000,
                                "zoneRedundant": false,
                                "readScale": "Disabled",
                                "requestedBackupStorageRedundancy": "Local",
                                "isLedgerOn": false,
                                "availabilityZone": "NoPreference"
                              },
                              "tags": "[union(variables('commonTags'), createObject('environment', 'PRODUCTION', 'deployment', 'Bicep'))]",
                              "dependsOn": [
                                "sqlServer"
                              ]
                            },
                            "sqlDatabaseSecondary": {
                              "type": "Microsoft.Sql/servers/databases",
                              "apiVersion": "2024-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('sqlServerName'), variables('sqlDatabaseSecondaryName'))]",
                              "location": "[parameters('sqlServerLocation')]",
                              "sku": {
                                "name": "GP_S_Gen5_2",
                                "tier": "GeneralPurpose"
                              },
                              "properties": {
                                "catalogCollation": "SQL_Latin1_General_CP1_CI_AS",
                                "collation": "SQL_Latin1_General_CP1_CI_AS",
                                "maxSizeBytes": 34359738368,
                                "zoneRedundant": false,
                                "readScale": "Disabled",
                                "requestedBackupStorageRedundancy": "Local",
                                "isLedgerOn": false,
                                "availabilityZone": "NoPreference",
                                "autoPauseDelay": 60,
                                "useFreeLimit": true,
                                "freeLimitExhaustionBehavior": "AutoPause"
                              },
                              "tags": "[union(variables('commonTags'), createObject('environment', 'PRODUCTION', 'deployment', 'Bicep'))]",
                              "dependsOn": [
                                "sqlDatabasePrimary",
                                "sqlServer"
                              ]
                            }
                          },
                          "outputs": {
                            "sqlServerName": {
                              "type": "string",
                              "value": "[parameters('sqlServerName')]"
                            },
                            "sqlServerResourceId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Sql/servers', parameters('sqlServerName'))]"
                            },
                            "sqlServerFqdn": {
                              "type": "string",
                              "value": "[reference('sqlServer').fullyQualifiedDomainName]"
                            }
                          }
                        }
                      }
                    },
                    "noSqlServerDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('noSqlServerDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "noSqlServerName": {
                            "value": "[variables('noSqlServerName')]"
                          },
                          "noSqlServerLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "noSqlServerDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "3356978295713412315"
                            },
                            "description": "This template will create a new Azure NoSQL server resource.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "noSqlServerName": {
                              "type": "string",
                              "metadata": {
                                "description": "The NoSQL Server name."
                              }
                            },
                            "noSqlServerLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the NoSQL Server resource."
                              }
                            },
                            "noSqlServerDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('noSqlServerDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "storage",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "noSqlServer::primaryNoSqlDatabase::invoicesContainer": {
                              "type": "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers",
                              "apiVersion": "2025-05-01-preview",
                              "name": "[format('{0}/{1}/{2}', parameters('noSqlServerName'), 'primary', 'invoices')]",
                              "properties": {
                                "resource": {
                                  "id": "invoices",
                                  "indexingPolicy": {
                                    "indexingMode": "consistent",
                                    "automatic": true,
                                    "includedPaths": [
                                      {
                                        "path": "/*"
                                      }
                                    ],
                                    "excludedPaths": [
                                      {
                                        "path": "/_etag/?"
                                      }
                                    ]
                                  },
                                  "partitionKey": {
                                    "paths": [
                                      "/UserIdentifier"
                                    ],
                                    "kind": "Hash",
                                    "version": 2
                                  },
                                  "uniqueKeyPolicy": {
                                    "uniqueKeys": []
                                  }
                                }
                              },
                              "dependsOn": [
                                "noSqlServer::primaryNoSqlDatabase"
                              ]
                            },
                            "noSqlServer::primaryNoSqlDatabase::merchantsContainer": {
                              "type": "Microsoft.DocumentDB/databaseAccounts/sqlDatabases/containers",
                              "apiVersion": "2025-05-01-preview",
                              "name": "[format('{0}/{1}/{2}', parameters('noSqlServerName'), 'primary', 'merchants')]",
                              "properties": {
                                "resource": {
                                  "id": "merchants",
                                  "indexingPolicy": {
                                    "indexingMode": "consistent",
                                    "automatic": true,
                                    "includedPaths": [
                                      {
                                        "path": "/*"
                                      }
                                    ],
                                    "excludedPaths": [
                                      {
                                        "path": "/_etag/?"
                                      }
                                    ]
                                  },
                                  "partitionKey": {
                                    "paths": [
                                      "/ParentCompanyId"
                                    ],
                                    "kind": "Hash",
                                    "version": 2
                                  },
                                  "uniqueKeyPolicy": {
                                    "uniqueKeys": []
                                  }
                                }
                              },
                              "dependsOn": [
                                "noSqlServer::primaryNoSqlDatabase"
                              ]
                            },
                            "noSqlServer::primaryNoSqlDatabase": {
                              "type": "Microsoft.DocumentDB/databaseAccounts/sqlDatabases",
                              "apiVersion": "2025-05-01-preview",
                              "name": "[format('{0}/{1}', parameters('noSqlServerName'), 'primary')]",
                              "location": "[parameters('noSqlServerLocation')]",
                              "properties": {
                                "resource": {
                                  "id": "primary"
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Primary NoSQL Database'))]",
                              "dependsOn": [
                                "noSqlServer"
                              ]
                            },
                            "noSqlServer": {
                              "type": "Microsoft.DocumentDB/databaseAccounts",
                              "apiVersion": "2025-05-01-preview",
                              "name": "[parameters('noSqlServerName')]",
                              "location": "[parameters('noSqlServerLocation')]",
                              "properties": {
                                "publicNetworkAccess": "Enabled",
                                "enableAutomaticFailover": false,
                                "enableMultipleWriteLocations": false,
                                "isVirtualNetworkFilterEnabled": false,
                                "virtualNetworkRules": [],
                                "disableKeyBasedMetadataWriteAccess": false,
                                "enableFreeTier": true,
                                "enableAnalyticalStorage": false,
                                "analyticalStorageConfiguration": {
                                  "schemaType": "WellDefined"
                                },
                                "createMode": "Default",
                                "databaseAccountOfferType": "Standard",
                                "defaultIdentity": "FirstPartyIdentity",
                                "networkAclBypass": "None",
                                "disableLocalAuth": false,
                                "enablePartitionMerge": false,
                                "enableBurstCapacity": false,
                                "minimalTlsVersion": "Tls12",
                                "consistencyPolicy": {
                                  "defaultConsistencyLevel": "Session",
                                  "maxIntervalInSeconds": 5,
                                  "maxStalenessPrefix": 100
                                },
                                "locations": [
                                  {
                                    "locationName": "[parameters('noSqlServerLocation')]",
                                    "failoverPriority": 0,
                                    "isZoneRedundant": false
                                  }
                                ],
                                "backupPolicy": {
                                  "type": "Continuous",
                                  "continuousModeProperties": {
                                    "tier": "Continuous7Days"
                                  }
                                },
                                "capacity": {
                                  "totalThroughputLimit": 1000
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'NoSQL Server'))]"
                            }
                          },
                          "outputs": {
                            "noSqlServerName": {
                              "type": "string",
                              "value": "[parameters('noSqlServerName')]"
                            }
                          }
                        }
                      }
                    }
                  },
                  "outputs": {
                    "storageAccountName": {
                      "type": "string",
                      "value": "[reference('storageAccountDeployment').outputs.storageAccountName.value]"
                    },
                    "storageAccountId": {
                      "type": "string",
                      "value": "[reference('storageAccountDeployment').outputs.storageAccountId.value]"
                    },
                    "storageAccountBlobEndpoint": {
                      "type": "string",
                      "value": "[reference('storageAccountDeployment').outputs.storageAccountBlobEndpoint.value]"
                    },
                    "sqlServerName": {
                      "type": "string",
                      "value": "[reference('sqlServerDeployment').outputs.sqlServerName.value]"
                    },
                    "cosmosAccountName": {
                      "type": "string",
                      "value": "[reference('noSqlServerDeployment').outputs.noSqlServerName.value]"
                    }
                  }
                }
              },
              "dependsOn": [
                "identitiesDeployment",
                "rbacDeployment"
              ]
            },
            "computeDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('computeDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "14232693853999173010"
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "defaultValue": "[utcNow()]",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "minLength": 1,
                      "maxLength": 20,
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the app service plans."
                      }
                    }
                  },
                  "resources": {
                    "appServicePlansDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('appServicePlansDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "appServicePlanLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "appServicePlanDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "appServicePlanConventionPrefix": {
                            "value": "[parameters('resourceConventionPrefix')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "5722274541305934919"
                            },
                            "description": "This template deploys two App Service Farms, in the same region, for production and development environments.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "appServicePlanLocation": {
                              "type": "string",
                              "allowedValues": [
                                "swedencentral",
                                "norwayeast",
                                "westeurope",
                                "northeurope"
                              ],
                              "metadata": {
                                "description": "The location for the app service plans."
                              }
                            },
                            "appServicePlanConventionPrefix": {
                              "type": "string",
                              "minLength": 1,
                              "maxLength": 20,
                              "metadata": {
                                "description": "The prefix for the app service plans."
                              }
                            },
                            "appServicePlanDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('appServicePlanDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "compute",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            },
                            "appPlans": [
                              {
                                "name": "[format('{0}-production', parameters('appServicePlanConventionPrefix'))]",
                                "location": "[parameters('appServicePlanLocation')]",
                                "sku": {
                                  "name": "B2",
                                  "tier": "Basic",
                                  "size": "B2",
                                  "capacity": 1
                                },
                                "properties": {
                                  "perSiteScaling": false,
                                  "elasticScaleEnabled": false,
                                  "maximumElasticWorkerCount": 1,
                                  "isSpot": false,
                                  "reserved": true,
                                  "isXenon": false,
                                  "hyperV": false,
                                  "targetWorkerCount": 0,
                                  "targetWorkerSizeId": 0,
                                  "zoneRedundant": false
                                }
                              },
                              {
                                "name": "[format('{0}-development', parameters('appServicePlanConventionPrefix'))]",
                                "location": "[parameters('appServicePlanLocation')]",
                                "sku": {
                                  "name": "B1",
                                  "tier": "Basic",
                                  "size": "B1",
                                  "capacity": 1
                                },
                                "properties": {
                                  "perSiteScaling": false,
                                  "elasticScaleEnabled": false,
                                  "maximumElasticWorkerCount": 1,
                                  "isSpot": false,
                                  "reserved": true,
                                  "isXenon": false,
                                  "hyperV": false,
                                  "targetWorkerCount": 0,
                                  "targetWorkerSizeId": 0,
                                  "zoneRedundant": false
                                }
                              }
                            ]
                          },
                          "resources": {
                            "appPlanFarm": {
                              "copy": {
                                "name": "appPlanFarm",
                                "count": "[length(variables('appPlans'))]"
                              },
                              "type": "Microsoft.Web/serverfarms",
                              "apiVersion": "2024-11-01",
                              "name": "[variables('appPlans')[copyIndex()].name]",
                              "location": "[variables('appPlans')[copyIndex()].location]",
                              "sku": "[variables('appPlans')[copyIndex()].sku]",
                              "kind": "linux",
                              "properties": "[variables('appPlans')[copyIndex()].properties]",
                              "tags": "[union(variables('commonTags'), createObject('tier', if(equals(variables('appPlans')[copyIndex()].name, format('{0}-production', parameters('appServicePlanConventionPrefix'))), 'production', 'development'), 'sku', variables('appPlans')[copyIndex()].sku.name, 'skuTier', variables('appPlans')[copyIndex()].sku.tier))]"
                            }
                          },
                          "outputs": {
                            "productionAppPlanId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Web/serverfarms', variables('appPlans')[0].name)]"
                            },
                            "developmentAppPlanId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Web/serverfarms', variables('appPlans')[1].name)]"
                            }
                          }
                        }
                      }
                    }
                  },
                  "outputs": {
                    "productionAppPlanId": {
                      "type": "string",
                      "value": "[reference('appServicePlansDeployment').outputs.productionAppPlanId.value]"
                    },
                    "developmentAppPlanId": {
                      "type": "string",
                      "value": "[reference('appServicePlansDeployment').outputs.developmentAppPlanId.value]"
                    }
                  }
                }
              },
              "dependsOn": [
                "identitiesDeployment"
              ]
            },
            "websiteDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('websiteDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "appInsightsConnectionString": {
                    "value": "[reference('observabilityDeployment').outputs.appInsightsConnectionString.value]"
                  },
                  "appInsightsInstrumentationKey": {
                    "value": "[reference('observabilityDeployment').outputs.appInsightsInstrumentationKey.value]"
                  },
                  "productionAppPlanId": {
                    "value": "[reference('computeDeployment').outputs.productionAppPlanId.value]"
                  },
                  "developmentAppPlanId": {
                    "value": "[reference('computeDeployment').outputs.developmentAppPlanId.value]"
                  },
                  "managedIdentityFrontendId": {
                    "value": "[reference('identitiesDeployment').outputs.managedIdentitiesList.value[0].resourceId]"
                  },
                  "managedIdentityBackendId": {
                    "value": "[reference('identitiesDeployment').outputs.managedIdentitiesList.value[1].resourceId]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "16726574790249516284"
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "defaultValue": "[utcNow()]",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    },
                    "productionAppPlanId": {
                      "type": "string",
                      "metadata": {
                        "description": "The ID of the production app service plan."
                      }
                    },
                    "developmentAppPlanId": {
                      "type": "string",
                      "metadata": {
                        "description": "The ID of the development app service plan."
                      }
                    },
                    "appInsightsConnectionString": {
                      "type": "string",
                      "metadata": {
                        "description": "The app insights connection string"
                      }
                    },
                    "appInsightsInstrumentationKey": {
                      "type": "string",
                      "metadata": {
                        "description": "The app insights instrumentation key"
                      }
                    },
                    "managedIdentityBackendId": {
                      "type": "string"
                    },
                    "managedIdentityFrontendId": {
                      "type": "string"
                    }
                  },
                  "resources": {
                    "apiWebsiteDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('apiWebsiteDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "appInsightsConnectionString": {
                            "value": "[parameters('appInsightsConnectionString')]"
                          },
                          "appInsightsInstrumentationKey": {
                            "value": "[parameters('appInsightsInstrumentationKey')]"
                          },
                          "apiWebsiteLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "apiWebsitePlanId": {
                            "value": "[parameters('productionAppPlanId')]"
                          },
                          "apiWebsiteIdentityId": {
                            "value": "[parameters('managedIdentityBackendId')]"
                          },
                          "apiWebsiteDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "3728004422972721481"
                            },
                            "description": "This template will create the api.arolariu.ro app service site.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "apiWebsitePlanId": {
                              "type": "string"
                            },
                            "apiWebsiteLocation": {
                              "type": "string"
                            },
                            "apiWebsiteIdentityId": {
                              "type": "string"
                            },
                            "apiWebsiteDeploymentDate": {
                              "type": "string"
                            },
                            "appInsightsInstrumentationKey": {
                              "type": "string"
                            },
                            "appInsightsConnectionString": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('apiWebsiteDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "sites",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "apiWebsite": {
                              "type": "Microsoft.Web/sites",
                              "apiVersion": "2024-11-01",
                              "name": "api-arolariu-ro",
                              "location": "[parameters('apiWebsiteLocation')]",
                              "kind": "app,linux",
                              "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                  "[format('{0}', parameters('apiWebsiteIdentityId'))]": {}
                                }
                              },
                              "properties": {
                                "enabled": true,
                                "serverFarmId": "[parameters('apiWebsitePlanId')]",
                                "reserved": true,
                                "isXenon": false,
                                "hyperV": false,
                                "siteConfig": {
                                  "alwaysOn": true,
                                  "numberOfWorkers": 1,
                                  "http20Enabled": true,
                                  "functionAppScaleLimit": 0,
                                  "minimumElasticInstanceCount": 0,
                                  "linuxFxVersion": "DOTNETCORE|8.0",
                                  "requestTracingEnabled": true,
                                  "remoteDebuggingEnabled": false,
                                  "httpLoggingEnabled": true,
                                  "logsDirectorySizeLimit": 35,
                                  "detailedErrorLoggingEnabled": false,
                                  "use32BitWorkerProcess": false,
                                  "webSocketsEnabled": true,
                                  "loadBalancing": "LeastRequests",
                                  "preWarmedInstanceCount": 0,
                                  "ftpsState": "Disabled",
                                  "minTlsVersion": "1.2",
                                  "appSettings": [
                                    {
                                      "name": "ASPNETCORE_ENVIRONMENT",
                                      "value": "Production"
                                    },
                                    {
                                      "name": "APPINSIGHTS_INSTRUMENTATIONKEY",
                                      "value": "[parameters('appInsightsInstrumentationKey')]"
                                    },
                                    {
                                      "name": "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                      "value": "[parameters('appInsightsConnectionString')]"
                                    },
                                    {
                                      "name": "ApplicationInsightsAgent_EXTENSION_VERSION",
                                      "value": "~2"
                                    },
                                    {
                                      "name": "APPLICATIONINSIGHTS_ENABLESQLQUERYCOLLECTION",
                                      "value": "true"
                                    }
                                  ]
                                },
                                "scmSiteAlsoStopped": false,
                                "clientAffinityEnabled": false,
                                "clientCertEnabled": false,
                                "clientCertMode": "Required",
                                "hostNamesDisabled": false,
                                "containerSize": 0,
                                "dailyMemoryTimeQuota": 0,
                                "httpsOnly": true,
                                "redundancyMode": "None",
                                "publicNetworkAccess": "Enabled",
                                "storageAccountRequired": false,
                                "keyVaultReferenceIdentity": "[parameters('apiWebsiteIdentityId')]"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'API Website'))]"
                            }
                          },
                          "outputs": {
                            "apiWebsiteUrl": {
                              "type": "string",
                              "value": "[reference('apiWebsite').defaultHostName]"
                            },
                            "apiWebsiteName": {
                              "type": "string",
                              "value": "api-arolariu-ro"
                            }
                          }
                        }
                      }
                    },
                    "mainWebsiteDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('mainWebsiteDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "appInsightsConnectionString": {
                            "value": "[parameters('appInsightsConnectionString')]"
                          },
                          "appInsightsInstrumentationKey": {
                            "value": "[parameters('appInsightsInstrumentationKey')]"
                          },
                          "productionWebsiteLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "productionWebsiteAppPlanId": {
                            "value": "[parameters('productionAppPlanId')]"
                          },
                          "productionWebsiteIdentityId": {
                            "value": "[parameters('managedIdentityFrontendId')]"
                          },
                          "productionWebsiteDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "18317745973337405004"
                            },
                            "description": "This template will create the arolariu.ro app service site.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "productionWebsiteLocation": {
                              "type": "string"
                            },
                            "productionWebsiteAppPlanId": {
                              "type": "string"
                            },
                            "productionWebsiteIdentityId": {
                              "type": "string"
                            },
                            "productionWebsiteDeploymentDate": {
                              "type": "string"
                            },
                            "appInsightsInstrumentationKey": {
                              "type": "string"
                            },
                            "appInsightsConnectionString": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('productionWebsiteDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "sites",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "mainWebsite": {
                              "type": "Microsoft.Web/sites",
                              "apiVersion": "2024-11-01",
                              "name": "www-arolariu-ro",
                              "location": "[parameters('productionWebsiteLocation')]",
                              "kind": "app,linux,container",
                              "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                  "[format('{0}', parameters('productionWebsiteIdentityId'))]": {}
                                }
                              },
                              "properties": {
                                "clientAffinityEnabled": true,
                                "clientCertEnabled": false,
                                "reserved": true,
                                "isXenon": false,
                                "hyperV": false,
                                "hostNamesDisabled": false,
                                "containerSize": 0,
                                "httpsOnly": true,
                                "redundancyMode": "None",
                                "publicNetworkAccess": "Enabled",
                                "storageAccountRequired": false,
                                "enabled": true,
                                "serverFarmId": "[parameters('productionWebsiteAppPlanId')]",
                                "siteConfig": {
                                  "acrUseManagedIdentityCreds": false,
                                  "publishingUsername": "$arolariu",
                                  "autoHealEnabled": false,
                                  "numberOfWorkers": 1,
                                  "functionAppScaleLimit": 0,
                                  "linuxFxVersion": "NODE|22-lts",
                                  "minimumElasticInstanceCount": 1,
                                  "alwaysOn": true,
                                  "cors": {
                                    "allowedOrigins": [
                                      "https://clerk.arolariu.ro",
                                      "https://api.arolariu.ro",
                                      "https://cdn.arolariu.ro"
                                    ]
                                  },
                                  "localMySqlEnabled": false,
                                  "ftpsState": "Disabled",
                                  "healthCheckPath": "/",
                                  "http20Enabled": true,
                                  "httpLoggingEnabled": true,
                                  "logsDirectorySizeLimit": 50,
                                  "detailedErrorLoggingEnabled": false,
                                  "scmType": "GithubAction",
                                  "scmIpSecurityRestrictionsDefaultAction": "Allow",
                                  "scmIpSecurityRestrictionsUseMain": false,
                                  "use32BitWorkerProcess": false,
                                  "loadBalancing": "LeastRequests",
                                  "ipSecurityRestrictions": [
                                    {
                                      "ipAddress": "AzureFrontDoor.Backend",
                                      "action": "Allow",
                                      "tag": "ServiceTag",
                                      "priority": 100,
                                      "name": "AzureFrontDoor"
                                    },
                                    {
                                      "ipAddress": "AzureCloud",
                                      "action": "Allow",
                                      "tag": "ServiceTag",
                                      "priority": 200,
                                      "name": "AzureCloud"
                                    },
                                    {
                                      "ipAddress": "AzureActiveDirectory",
                                      "action": "Allow",
                                      "tag": "ServiceTag",
                                      "priority": 300,
                                      "name": "AzureActiveDirectory"
                                    },
                                    {
                                      "ipAddress": "Any",
                                      "action": "Deny",
                                      "priority": 2147483647,
                                      "name": "Deny all",
                                      "description": "Deny all access"
                                    }
                                  ],
                                  "ipSecurityRestrictionsDefaultAction": "Deny",
                                  "minTlsVersion": "1.2",
                                  "nodeVersion": "22",
                                  "webSocketsEnabled": true,
                                  "appSettings": [
                                    {
                                      "name": "NODE_ENV",
                                      "value": "Production"
                                    },
                                    {
                                      "name": "APPINSIGHTS_INSTRUMENTATIONKEY",
                                      "value": "[parameters('appInsightsInstrumentationKey')]"
                                    },
                                    {
                                      "name": "APPLICATIONINSIGHTS_CONNECTION_STRING",
                                      "value": "[parameters('appInsightsConnectionString')]"
                                    },
                                    {
                                      "name": "ApplicationInsightsAgent_EXTENSION_VERSION",
                                      "value": "~3"
                                    }
                                  ]
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Main Website'))]"
                            }
                          },
                          "outputs": {
                            "mainWebsiteUrl": {
                              "type": "string",
                              "value": "[reference('mainWebsite').defaultHostName]"
                            },
                            "mainWebsiteName": {
                              "type": "string",
                              "value": "www-arolariu-ro"
                            }
                          }
                        }
                      }
                    },
                    "devWebsiteDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('devWebsiteDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "developmentWebsiteLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "developmentWebsiteAppPlanId": {
                            "value": "[parameters('developmentAppPlanId')]"
                          },
                          "developmentWebsiteIdentityId": {
                            "value": "[parameters('managedIdentityFrontendId')]"
                          },
                          "developmentWebsiteDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "14426492962285851905"
                            },
                            "description": "This template will create the dev.arolariu.ro app service site.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "developmentWebsiteLocation": {
                              "type": "string"
                            },
                            "developmentWebsiteAppPlanId": {
                              "type": "string"
                            },
                            "developmentWebsiteIdentityId": {
                              "type": "string"
                            },
                            "developmentWebsiteDeploymentDate": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "DEVELOPMENT",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('developmentWebsiteDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "sites",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "devWebsite": {
                              "type": "Microsoft.Web/sites",
                              "apiVersion": "2024-11-01",
                              "name": "dev-arolariu-ro",
                              "location": "[parameters('developmentWebsiteLocation')]",
                              "kind": "app,linux,container",
                              "identity": {
                                "type": "UserAssigned",
                                "userAssignedIdentities": {
                                  "[format('{0}', parameters('developmentWebsiteIdentityId'))]": {}
                                }
                              },
                              "properties": {
                                "clientAffinityEnabled": true,
                                "clientCertEnabled": false,
                                "reserved": true,
                                "isXenon": false,
                                "hyperV": false,
                                "hostNamesDisabled": false,
                                "containerSize": 0,
                                "httpsOnly": true,
                                "redundancyMode": "None",
                                "publicNetworkAccess": "Enabled",
                                "storageAccountRequired": false,
                                "enabled": true,
                                "serverFarmId": "[parameters('developmentWebsiteAppPlanId')]",
                                "siteConfig": {
                                  "acrUseManagedIdentityCreds": false,
                                  "publishingUsername": "$dev-arolariu",
                                  "autoHealEnabled": false,
                                  "numberOfWorkers": 1,
                                  "functionAppScaleLimit": 0,
                                  "linuxFxVersion": "NODE|22-lts",
                                  "minimumElasticInstanceCount": 0,
                                  "alwaysOn": true,
                                  "cors": {
                                    "allowedOrigins": [
                                      "https://clerk.arolariu.ro",
                                      "https://api.arolariu.ro",
                                      "https://cdn.arolariu.ro"
                                    ]
                                  },
                                  "localMySqlEnabled": false,
                                  "ftpsState": "Disabled",
                                  "healthCheckPath": "/",
                                  "http20Enabled": true,
                                  "httpLoggingEnabled": true,
                                  "logsDirectorySizeLimit": 50,
                                  "detailedErrorLoggingEnabled": false,
                                  "scmType": "GithubAction",
                                  "scmIpSecurityRestrictionsDefaultAction": "Allow",
                                  "scmIpSecurityRestrictionsUseMain": false,
                                  "use32BitWorkerProcess": false,
                                  "loadBalancing": "LeastRequests",
                                  "ipSecurityRestrictions": [
                                    {
                                      "ipAddress": "Any",
                                      "action": "Allow",
                                      "priority": 2147483647,
                                      "tag": "Default",
                                      "name": "Allow All",
                                      "description": "Allow all access."
                                    }
                                  ],
                                  "ipSecurityRestrictionsDefaultAction": "Allow",
                                  "minTlsVersion": "1.2",
                                  "nodeVersion": "22",
                                  "webSocketsEnabled": true
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Development Website'))]"
                            }
                          },
                          "outputs": {
                            "devWebsiteUrl": {
                              "type": "string",
                              "value": "[reference('devWebsite').defaultHostName]"
                            },
                            "devWebsiteName": {
                              "type": "string",
                              "value": "dev-arolariu-ro"
                            }
                          }
                        }
                      }
                    },
                    "docsWebsiteDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('docsWebsiteDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "staticWebAppDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "1734247106254286710"
                            },
                            "description": "This template will create the docs.arolariu.ro static web app site.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "staticWebAppLocation": {
                              "type": "string",
                              "defaultValue": "westeurope"
                            },
                            "staticWebAppDeploymentDate": {
                              "type": "string"
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('staticWebAppDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "sites",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "docsStaticWebApp": {
                              "type": "Microsoft.Web/staticSites",
                              "apiVersion": "2024-11-01",
                              "name": "docs-arolariu-ro",
                              "location": "[parameters('staticWebAppLocation')]",
                              "sku": {
                                "name": "Free",
                                "tier": "Free"
                              },
                              "properties": {
                                "repositoryUrl": "https://github.com/arolariu/arolariu.ro",
                                "branch": "main",
                                "stagingEnvironmentPolicy": "Disabled",
                                "allowConfigFileUpdates": true,
                                "provider": "GitHub",
                                "enterpriseGradeCdnStatus": "Disabled"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Docs Static Web App', 'resourceType', 'Static Web App'))]"
                            }
                          },
                          "outputs": {
                            "docsWebsiteUrl": {
                              "type": "string",
                              "value": "[reference('docsStaticWebApp').defaultHostname]"
                            },
                            "docsWebsiteName": {
                              "type": "string",
                              "value": "docs-arolariu-ro"
                            }
                          }
                        }
                      }
                    }
                  },
                  "outputs": {
                    "mainWebsiteUrl": {
                      "type": "string",
                      "value": "[reference('mainWebsiteDeployment').outputs.mainWebsiteUrl.value]"
                    },
                    "apiWebsiteUrl": {
                      "type": "string",
                      "value": "[reference('apiWebsiteDeployment').outputs.apiWebsiteUrl.value]"
                    },
                    "devWebsiteUrl": {
                      "type": "string",
                      "value": "[reference('devWebsiteDeployment').outputs.devWebsiteUrl.value]"
                    },
                    "docsWebsiteUrl": {
                      "type": "string",
                      "value": "[reference('docsWebsiteDeployment').outputs.docsWebsiteUrl.value]"
                    },
                    "mainWebsiteName": {
                      "type": "string",
                      "value": "[reference('mainWebsiteDeployment').outputs.mainWebsiteName.value]"
                    },
                    "apiWebsiteName": {
                      "type": "string",
                      "value": "[reference('apiWebsiteDeployment').outputs.apiWebsiteName.value]"
                    },
                    "devWebsiteName": {
                      "type": "string",
                      "value": "[reference('devWebsiteDeployment').outputs.devWebsiteName.value]"
                    },
                    "docsWebsiteName": {
                      "type": "string",
                      "value": "[reference('docsWebsiteDeployment').outputs.docsWebsiteName.value]"
                    }
                  }
                }
              },
              "dependsOn": [
                "computeDeployment",
                "configurationDeployment",
                "identitiesDeployment",
                "observabilityDeployment",
                "storageDeployment"
              ]
            },
            "networkDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('networkDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  },
                  "mainWebsiteHostname": {
                    "value": "[reference('websiteDeployment').outputs.mainWebsiteUrl.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "10612609302387163257"
                    }
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "mainWebsiteHostname": {
                      "type": "string",
                      "metadata": {
                        "description": "The hostname of the main production website."
                      }
                    }
                  },
                  "variables": {
                    "azureFrontDoorName": "[format('{0}-afd', parameters('resourceConventionPrefix'))]",
                    "dnsZoneName": "arolariu.ro"
                  },
                  "resources": {
                    "azureFrontDoorDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('azureFrontDoorDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "frontDoorName": {
                            "value": "[variables('azureFrontDoorName')]"
                          },
                          "frontDoorDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "mainWebsiteHostname": {
                            "value": "[parameters('mainWebsiteHostname')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "17959643213433893670"
                            },
                            "description": "This template will deploy an Azure Front Door resource with production-ready configuration.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "frontDoorName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the Front Door resource."
                              }
                            },
                            "frontDoorDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the Front Door deployment is executed."
                              }
                            },
                            "mainWebsiteHostname": {
                              "type": "string",
                              "metadata": {
                                "description": "The hostname of the main production website."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('frontDoorDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "network",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "frontDoorProfile::productionOriginGroup::productionOrigin": {
                              "type": "Microsoft.Cdn/profiles/originGroups/origins",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}/{2}', parameters('frontDoorName'), 'production', 'production-origin')]",
                              "properties": {
                                "hostName": "[parameters('mainWebsiteHostname')]",
                                "httpPort": 80,
                                "httpsPort": 443,
                                "originHostHeader": "[parameters('mainWebsiteHostname')]",
                                "priority": 1,
                                "weight": 1000,
                                "enabledState": "Enabled",
                                "enforceCertificateNameCheck": false
                              },
                              "dependsOn": [
                                "frontDoorProfile::productionOriginGroup"
                              ]
                            },
                            "frontDoorProfile::productionEndpoint::productionRoute": {
                              "type": "Microsoft.Cdn/profiles/afdEndpoints/routes",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}/{2}', parameters('frontDoorName'), 'production', 'production-route')]",
                              "properties": {
                                "customDomains": [
                                  {
                                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('frontDoorName'), 'apex-arolariu-ro')]"
                                  },
                                  {
                                    "id": "[resourceId('Microsoft.Cdn/profiles/customDomains', parameters('frontDoorName'), 'www-arolariu-ro')]"
                                  }
                                ],
                                "originGroup": {
                                  "id": "[resourceId('Microsoft.Cdn/profiles/originGroups', parameters('frontDoorName'), 'production')]"
                                },
                                "supportedProtocols": [
                                  "Https"
                                ],
                                "patternsToMatch": [
                                  "/*"
                                ],
                                "httpsRedirect": "Enabled",
                                "linkToDefaultDomain": "Enabled",
                                "forwardingProtocol": "HttpsOnly",
                                "cacheConfiguration": {
                                  "queryStringCachingBehavior": "IgnoreQueryString"
                                },
                                "enabledState": "Enabled"
                              },
                              "dependsOn": [
                                "frontDoorProfile::apexCustomDomain",
                                "frontDoorProfile::productionEndpoint",
                                "frontDoorProfile::productionOriginGroup",
                                "frontDoorProfile::productionOriginGroup::productionOrigin",
                                "frontDoorProfile::wwwCustomDomain"
                              ]
                            },
                            "frontDoorProfile::wafPolicy": {
                              "type": "Microsoft.Cdn/profiles/securityPolicies",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'productionWAF')]",
                              "properties": {
                                "parameters": {
                                  "wafPolicy": {
                                    "id": "[resourceId('Microsoft.Network/FrontDoorWebApplicationFirewallPolicies', 'productionWAF')]"
                                  },
                                  "type": "WebApplicationFirewall",
                                  "associations": [
                                    {
                                      "domains": [
                                        {
                                          "id": "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('frontDoorName'), 'production')]"
                                        }
                                      ],
                                      "patternsToMatch": [
                                        "/*"
                                      ]
                                    }
                                  ]
                                }
                              },
                              "dependsOn": [
                                "frontDoorProfile",
                                "frontDoorProfile::productionEndpoint",
                                "frontDoorWebApplicationFirewall"
                              ]
                            },
                            "frontDoorProfile::apexCustomDomain": {
                              "type": "Microsoft.Cdn/profiles/customDomains",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'apex-arolariu-ro')]",
                              "properties": {
                                "hostName": "arolariu.ro",
                                "tlsSettings": {
                                  "certificateType": "ManagedCertificate",
                                  "minimumTlsVersion": "TLS12"
                                }
                              },
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorProfile::wwwCustomDomain": {
                              "type": "Microsoft.Cdn/profiles/customDomains",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'www-arolariu-ro')]",
                              "properties": {
                                "hostName": "www.arolariu.ro",
                                "tlsSettings": {
                                  "certificateType": "ManagedCertificate",
                                  "minimumTlsVersion": "TLS12"
                                }
                              },
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorProfile::cdnCustomDomain": {
                              "type": "Microsoft.Cdn/profiles/customDomains",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'cdn-arolariu-ro')]",
                              "properties": {
                                "hostName": "cdn.arolariu.ro",
                                "tlsSettings": {
                                  "certificateType": "ManagedCertificate",
                                  "minimumTlsVersion": "TLS12"
                                }
                              },
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorProfile::productionOriginGroup": {
                              "type": "Microsoft.Cdn/profiles/originGroups",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'production')]",
                              "properties": {
                                "sessionAffinityState": "Enabled",
                                "loadBalancingSettings": {
                                  "sampleSize": 4,
                                  "successfulSamplesRequired": 3,
                                  "additionalLatencyInMilliseconds": 50
                                },
                                "healthProbeSettings": {
                                  "probePath": "/",
                                  "probeRequestType": "HEAD",
                                  "probeProtocol": "Https",
                                  "probeIntervalInSeconds": 100
                                }
                              },
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorProfile::productionEndpoint": {
                              "type": "Microsoft.Cdn/profiles/afdEndpoints",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'production')]",
                              "location": "Global",
                              "properties": {
                                "enabledState": "Enabled"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Production Endpoint'))]",
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorProfile::cdnEndpoint": {
                              "type": "Microsoft.Cdn/profiles/afdEndpoints",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'cdn')]",
                              "location": "Global",
                              "properties": {
                                "enabledState": "Enabled"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'CDN Endpoint'))]",
                              "dependsOn": [
                                "frontDoorProfile"
                              ]
                            },
                            "frontDoorWebApplicationFirewall": {
                              "type": "Microsoft.Network/FrontDoorWebApplicationFirewallPolicies",
                              "apiVersion": "2024-02-01",
                              "name": "productionWAF",
                              "location": "Global",
                              "sku": {
                                "name": "Standard_AzureFrontDoor"
                              },
                              "properties": {
                                "policySettings": {
                                  "enabledState": "Enabled",
                                  "mode": "Detection",
                                  "requestBodyCheck": "Enabled"
                                },
                                "customRules": {
                                  "rules": []
                                },
                                "managedRules": {
                                  "managedRuleSets": []
                                }
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'WAF Policy for Azure Front Door', 'resourceType', 'WAF Policy'))]"
                            },
                            "frontDoorProfile": {
                              "type": "Microsoft.Cdn/profiles",
                              "apiVersion": "2025-04-15",
                              "name": "[parameters('frontDoorName')]",
                              "location": "Global",
                              "sku": {
                                "name": "Standard_AzureFrontDoor"
                              },
                              "properties": {
                                "originResponseTimeoutSeconds": 16
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Azure Front Door Profile', 'resourceType', 'CDN Profile'))]"
                            }
                          },
                          "outputs": {
                            "frontDoorProductionFqdn": {
                              "type": "string",
                              "value": "[reference('frontDoorProfile::productionEndpoint').hostName]"
                            },
                            "frontDoorCdnFqdn": {
                              "type": "string",
                              "value": "[reference('frontDoorProfile::cdnEndpoint').hostName]"
                            },
                            "frontDoorProfileId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.Cdn/profiles', parameters('frontDoorName'))]"
                            },
                            "frontDoorApexToken": {
                              "type": "string",
                              "value": "[reference('frontDoorProfile::apexCustomDomain').validationProperties.validationToken]"
                            },
                            "frontDoorWwwToken": {
                              "type": "string",
                              "value": "[reference('frontDoorProfile::wwwCustomDomain').validationProperties.validationToken]"
                            },
                            "frontDoorCdnToken": {
                              "type": "string",
                              "value": "[reference('frontDoorProfile::cdnCustomDomain').validationProperties.validationToken]"
                            }
                          }
                        }
                      }
                    },
                    "dnsZoneDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('dnsZoneDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dnsZoneName": {
                            "value": "[variables('dnsZoneName')]"
                          },
                          "dnsZoneDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "frontDoorName": {
                            "value": "[variables('azureFrontDoorName')]"
                          },
                          "frontDoorProductionFqdn": {
                            "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorProductionFqdn.value]"
                          },
                          "frontDoorApexCustomDomainValidationToken": {
                            "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorApexToken.value]"
                          },
                          "frontDoorWwwCustomDomainValidationToken": {
                            "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorWwwToken.value]"
                          },
                          "frontDoorCdnCustomDomainValidationToken": {
                            "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorCdnToken.value]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "6828826794179374836"
                            },
                            "description": "This template will create the necessary Azure DNS Zone resources for arolariu.ro with dynamic DNS records",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "dnsZoneName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the Azure DNS Zone resource."
                              }
                            },
                            "dnsZoneDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            },
                            "frontDoorName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the Azure Front Door profile."
                              }
                            },
                            "frontDoorProductionFqdn": {
                              "type": "string",
                              "metadata": {
                                "description": "The FQDN of the Azure Front Door production endpoint."
                              }
                            },
                            "frontDoorApexCustomDomainValidationToken": {
                              "type": "string",
                              "metadata": {
                                "description": "The Azure Front Door APEX custom domain validation token."
                              }
                            },
                            "frontDoorWwwCustomDomainValidationToken": {
                              "type": "string",
                              "metadata": {
                                "description": "The Azure Front Door WWW custom domain validation token."
                              }
                            },
                            "frontDoorCdnCustomDomainValidationToken": {
                              "type": "string",
                              "metadata": {
                                "description": "The Azure Front Door CDN custom domain validation token."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('dnsZoneDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "network",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "dnsZone::dnssecResource": {
                              "type": "Microsoft.Network/dnsZones/dnssecConfigs",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'default')]",
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::apexRecord": {
                              "type": "Microsoft.Network/dnsZones/A",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), '@')]",
                              "properties": {
                                "TTL": 3600,
                                "targetResource": {
                                  "id": "[resourceId('Microsoft.Cdn/profiles/afdEndpoints', parameters('frontDoorName'), 'production')]"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::wwwRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'www')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "[parameters('frontDoorProductionFqdn')]"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::frontDoorApexTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), '_dnsauth')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "[parameters('frontDoorApexCustomDomainValidationToken')]"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::frontDoorWwwTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), '_dnsauth.www')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "[parameters('frontDoorWwwCustomDomainValidationToken')]"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::frontDoorCdnTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), '_dnsauth.cdn')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "[parameters('frontDoorCdnCustomDomainValidationToken')]"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::clerkAuthCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'clerk')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "frontend-api.clerk.services"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::clerkAccountsCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'accounts')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "accounts.clerk.services"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::clerkMailCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'clkmail')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "<your-clerk-mail-service-cname>"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::clerkMailKeyCnameRecord1": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'clk._domainkey')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "<your-clerk-mail-service-cname>"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::clerkMailKeyCnameRecord2": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'clk2._domainkey')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "<your-clerk-mail-service-cname>"
                                }
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::resendMxRecord": {
                              "type": "Microsoft.Network/dnsZones/MX",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'send.mail')]",
                              "properties": {
                                "TTL": 3600,
                                "MXRecords": [
                                  {
                                    "preference": 10,
                                    "exchange": "<your-amazon-ses-endpoint>"
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::resendTxtRecord1": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'send.mail')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "v=spf1 include:amazonses.com ~all"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::resendTxtRecord2": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'resend._domainkey.mail')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "v=DKIM1; k=rsa; p=<your-dkim-public-key>"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "dnsZone::dmarcTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), '_dmarc')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "v=DMARC1; p=none; rua=mailto:admin@arolariu.ro"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "dnsZone"
                              ]
                            },
                            "frontDoor": {
                              "existing": true,
                              "type": "Microsoft.Cdn/profiles",
                              "apiVersion": "2025-04-15",
                              "name": "[parameters('frontDoorName')]"
                            },
                            "frontDoorProductionEndpoint": {
                              "existing": true,
                              "type": "Microsoft.Cdn/profiles/afdEndpoints",
                              "apiVersion": "2025-04-15",
                              "name": "[format('{0}/{1}', parameters('frontDoorName'), 'production')]"
                            },
                            "dnsZone": {
                              "type": "Microsoft.Network/dnsZones",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[parameters('dnsZoneName')]",
                              "location": "Global",
                              "properties": {
                                "zoneType": "Public"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'DNS Zone for arolariu.ro', 'resourceType', 'DNS Zone'))]"
                            }
                          },
                          "outputs": {
                            "dnsZoneNameServers": {
                              "type": "array",
                              "value": "[reference('dnsZone').nameServers]"
                            },
                            "dnsZoneName": {
                              "type": "string",
                              "value": "[parameters('dnsZoneName')]"
                            }
                          }
                        }
                      },
                      "dependsOn": [
                        "azureFrontDoorDeployment"
                      ]
                    }
                  },
                  "outputs": {
                    "frontDoorProductionFqdn": {
                      "type": "string",
                      "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorProductionFqdn.value]"
                    },
                    "frontDoorCdnFqdn": {
                      "type": "string",
                      "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorCdnFqdn.value]"
                    },
                    "frontDoorProfileId": {
                      "type": "string",
                      "value": "[reference('azureFrontDoorDeployment').outputs.frontDoorProfileId.value]"
                    },
                    "dnsZoneName": {
                      "type": "string",
                      "value": "[reference('dnsZoneDeployment').outputs.dnsZoneName.value]"
                    }
                  }
                }
              },
              "dependsOn": [
                "websiteDeployment"
              ]
            },
            "aiDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('aiDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  },
                  "backendManagedIdentityPrincipalId": {
                    "value": "[reference('identitiesDeployment').outputs.managedIdentitiesList.value[1].principalId]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "15923843344574745688"
                    },
                    "description": "This file acts as a deployment file for all the AI resources.",
                    "author": "Alexandru-Razvan Olariu"
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "backendManagedIdentityPrincipalId": {
                      "type": "string",
                      "metadata": {
                        "description": "The backend managed identity principal id to which we will grant access to the AI services."
                      }
                    }
                  },
                  "variables": {
                    "aiConventionPrefix": "[format('{0}-ai', parameters('resourceConventionPrefix'))]"
                  },
                  "resources": {
                    "openAiDeployment": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('openAiDeployment-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "openAiLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "openAiConventionPrefix": {
                            "value": "[variables('aiConventionPrefix')]"
                          },
                          "openAiDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          },
                          "backendManagedIdentityPrincipalId": {
                            "value": "[parameters('backendManagedIdentityPrincipalId')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "5766124034634170686"
                            },
                            "description": "This file contains the bicep code for deploying the Azure OpenAI service.",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "openAiLocation": {
                              "type": "string",
                              "allowedValues": [
                                "swedencentral",
                                "norwayeast",
                                "westeurope",
                                "northeurope"
                              ],
                              "metadata": {
                                "description": "The location for the OpenAI service."
                              }
                            },
                            "openAiDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The date when the deployment is executed."
                              }
                            },
                            "openAiConventionPrefix": {
                              "type": "string",
                              "metadata": {
                                "description": "The prefix to use for the names of the resources."
                              }
                            },
                            "backendManagedIdentityPrincipalId": {
                              "type": "string",
                              "metadata": {
                                "description": "The backend managed identity principal id to which we will grant access to the AI services."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "PRODUCTION",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('openAiDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "ai",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "openAi": {
                              "type": "Microsoft.CognitiveServices/accounts",
                              "apiVersion": "2025-04-01-preview",
                              "name": "[format('{0}-openai', parameters('openAiConventionPrefix'))]",
                              "location": "[parameters('openAiLocation')]",
                              "sku": {
                                "name": "S0"
                              },
                              "kind": "OpenAI",
                              "properties": {
                                "customSubDomainName": "[format('{0}-openai', parameters('openAiConventionPrefix'))]",
                                "publicNetworkAccess": "Enabled"
                              },
                              "tags": "[union(variables('commonTags'), createObject('sku', 'Free Tier'))]"
                            },
                            "openAiRoleAssignment": {
                              "type": "Microsoft.Authorization/roleAssignments",
                              "apiVersion": "2022-04-01",
                              "scope": "[format('Microsoft.CognitiveServices/accounts/{0}', format('{0}-openai', parameters('openAiConventionPrefix')))]",
                              "name": "[guid(resourceId('Microsoft.CognitiveServices/accounts', format('{0}-openai', parameters('openAiConventionPrefix'))), parameters('backendManagedIdentityPrincipalId'), 'Cognitive Services User')]",
                              "properties": {
                                "roleDefinitionId": "[resourceId('Microsoft.Authorization/roleDefinitions', 'a97b65f3-24c7-4388-baec-2e87135dc908')]",
                                "principalId": "[parameters('backendManagedIdentityPrincipalId')]",
                                "principalType": "ServicePrincipal"
                              },
                              "dependsOn": [
                                "openAi"
                              ]
                            }
                          },
                          "outputs": {
                            "openAiId": {
                              "type": "string",
                              "value": "[resourceId('Microsoft.CognitiveServices/accounts', format('{0}-openai', parameters('openAiConventionPrefix')))]"
                            },
                            "openAiEndpoint": {
                              "type": "string",
                              "value": "[reference('openAi').endpoint]"
                            },
                            "resource": {
                              "type": "object",
                              "value": "[reference('openAi', '2025-04-01-preview', 'full')]"
                            }
                          }
                        }
                      }
                    }
                  },
                  "outputs": {
                    "aiResources": {
                      "type": "object",
                      "value": {
                        "openAiId": "[reference('openAiDeployment').outputs.openAiId.value]",
                        "openAiEndpoint": "[reference('openAiDeployment').outputs.openAiEndpoint.value]"
                      }
                    }
                  }
                }
              },
              "dependsOn": [
                "identitiesDeployment"
              ]
            },
            "bindingsDeployment": {
              "type": "Microsoft.Resources/deployments",
              "apiVersion": "2022-09-01",
              "name": "[format('bindingsDeployment-{0}', parameters('resourceDeploymentDate'))]",
              "properties": {
                "expressionEvaluationOptions": {
                  "scope": "inner"
                },
                "mode": "Incremental",
                "parameters": {
                  "resourceLocation": {
                    "value": "[parameters('resourceLocation')]"
                  },
                  "resourceDeploymentDate": {
                    "value": "[parameters('resourceDeploymentDate')]"
                  },
                  "resourceConventionPrefix": {
                    "value": "[variables('resourceConventionPrefix')]"
                  },
                  "dnsZoneName": {
                    "value": "[reference('networkDeployment').outputs.dnsZoneName.value]"
                  },
                  "devWebsiteAppServicePlanId": {
                    "value": "[reference('computeDeployment').outputs.developmentAppPlanId.value]"
                  },
                  "prodWebsiteAppServicePlanId": {
                    "value": "[reference('computeDeployment').outputs.productionAppPlanId.value]"
                  },
                  "apiWebsiteHostname": {
                    "value": "[reference('websiteDeployment').outputs.apiWebsiteName.value]"
                  },
                  "devWebsiteHostname": {
                    "value": "[reference('websiteDeployment').outputs.devWebsiteName.value]"
                  },
                  "docsWebsiteHostname": {
                    "value": "[reference('websiteDeployment').outputs.docsWebsiteName.value]"
                  },
                  "prodWebsiteHostname": {
                    "value": "[reference('websiteDeployment').outputs.mainWebsiteName.value]"
                  }
                },
                "template": {
                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                  "languageVersion": "2.0",
                  "contentVersion": "1.0.0.0",
                  "metadata": {
                    "_generator": {
                      "name": "bicep",
                      "version": "0.36.1.42791",
                      "templateHash": "11757224462600723302"
                    },
                    "description": "This file acts as a deployment file for binding resources",
                    "author": "Alexandru-Razvan Olariu"
                  },
                  "parameters": {
                    "resourceDeploymentDate": {
                      "type": "string",
                      "metadata": {
                        "description": "The date when the deployment is executed."
                      }
                    },
                    "resourceLocation": {
                      "type": "string",
                      "allowedValues": [
                        "swedencentral",
                        "norwayeast",
                        "westeurope",
                        "northeurope"
                      ],
                      "metadata": {
                        "description": "The location for the resources."
                      }
                    },
                    "resourceConventionPrefix": {
                      "type": "string",
                      "metadata": {
                        "description": "The prefix to use for the names of the resources."
                      }
                    },
                    "dnsZoneName": {
                      "type": "string",
                      "metadata": {
                        "description": "The name of the Azure DNS Zone resource."
                      }
                    },
                    "devWebsiteAppServicePlanId": {
                      "type": "string",
                      "metadata": {
                        "description": "The development app service farm plan ID."
                      }
                    },
                    "prodWebsiteAppServicePlanId": {
                      "type": "string",
                      "metadata": {
                        "description": "The production app service farm plan ID."
                      }
                    },
                    "apiWebsiteHostname": {
                      "type": "string",
                      "metadata": {
                        "description": "The hostname of the API website."
                      }
                    },
                    "devWebsiteHostname": {
                      "type": "string",
                      "metadata": {
                        "description": "The hostname of the development website."
                      }
                    },
                    "docsWebsiteHostname": {
                      "type": "string",
                      "metadata": {
                        "description": "The hostname of the documentation website."
                      }
                    },
                    "prodWebsiteHostname": {
                      "type": "string",
                      "metadata": {
                        "description": "The hostname of the production website."
                      }
                    }
                  },
                  "resources": {
                    "devWebsiteBindings": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('devWebsiteBindings-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dnsZoneName": {
                            "value": "[parameters('dnsZoneName')]"
                          },
                          "devWebsiteHostname": {
                            "value": "[parameters('devWebsiteHostname')]"
                          },
                          "devWebsiteLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "devWebsiteAppServicePlanId": {
                            "value": "[parameters('devWebsiteAppServicePlanId')]"
                          },
                          "devWebsiteDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "17311639268757799794"
                            },
                            "description": "Custom domain binding and managed certificate for dev.arolariu.ro",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "dnsZoneName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the DNS zone for the custom domain."
                              }
                            },
                            "devWebsiteHostname": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the App Service to bind the custom domain to."
                              }
                            },
                            "devWebsiteLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the resources."
                              }
                            },
                            "devWebsiteAppServicePlanId": {
                              "type": "string",
                              "metadata": {
                                "description": "The App Service Plan ID."
                              }
                            },
                            "devWebsiteDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The deployment date."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "DEVELOPMENT",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('devWebsiteDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "bindings",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "devWebsite": {
                              "existing": true,
                              "type": "Microsoft.Web/sites",
                              "apiVersion": "2024-11-01",
                              "name": "[parameters('devWebsiteHostname')]"
                            },
                            "dnsZone": {
                              "existing": true,
                              "type": "Microsoft.Network/dnsZones",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[parameters('dnsZoneName')]"
                            },
                            "devCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'dev')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "[reference('devWebsite').defaultHostName]"
                                }
                              },
                              "dependsOn": [
                                "devWebsite"
                              ]
                            },
                            "devTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'asuid.dev')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "[reference('devWebsite').customDomainVerificationId]"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "devWebsite"
                              ]
                            },
                            "devCustomDomain": {
                              "type": "Microsoft.Web/sites/hostNameBindings",
                              "apiVersion": "2024-11-01",
                              "name": "[format('{0}/{1}', parameters('devWebsiteHostname'), 'dev.arolariu.ro')]",
                              "properties": {
                                "hostNameType": "Verified",
                                "sslState": "Disabled",
                                "customHostNameDnsRecordType": "CName",
                                "siteName": "[parameters('devWebsiteHostname')]"
                              },
                              "dependsOn": [
                                "devCnameRecord",
                                "devTxtRecord"
                              ]
                            },
                            "devManagedCertificate": {
                              "type": "Microsoft.Web/certificates",
                              "apiVersion": "2024-11-01",
                              "name": "cert-dev-arolariu-ro",
                              "location": "[parameters('devWebsiteLocation')]",
                              "properties": {
                                "serverFarmId": "[parameters('devWebsiteAppServicePlanId')]",
                                "canonicalName": "dev.arolariu.ro"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Development Managed Certificate', 'resourceType', 'SSL Certificate'))]",
                              "dependsOn": [
                                "devCustomDomain"
                              ]
                            },
                            "certificateBindings": {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "dev-arolariu-ro-certificate-bindings",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "devWebsiteHostname": {
                                    "value": "[parameters('devWebsiteHostname')]"
                                  },
                                  "devWebsiteThumbprint": {
                                    "value": "[reference('devManagedCertificate').thumbprint]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "languageVersion": "2.0",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.36.1.42791",
                                      "templateHash": "7786298197872401090"
                                    },
                                    "description": "Custom domain binding and managed certificate for dev.arolariu.ro",
                                    "author": "Alexandru-Razvan Olariu"
                                  },
                                  "parameters": {
                                    "devWebsiteHostname": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "The name of the App Service to bind the custom domain to."
                                      }
                                    },
                                    "devWebsiteThumbprint": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "The certificate thumbprint for SSL binding."
                                      }
                                    }
                                  },
                                  "resources": {
                                    "devWebsite": {
                                      "existing": true,
                                      "type": "Microsoft.Web/sites",
                                      "apiVersion": "2024-11-01",
                                      "name": "[parameters('devWebsiteHostname')]"
                                    },
                                    "devCustomDomainWithSsl": {
                                      "type": "Microsoft.Web/sites/hostNameBindings",
                                      "apiVersion": "2024-11-01",
                                      "name": "[format('{0}/{1}', parameters('devWebsiteHostname'), 'dev.arolariu.ro')]",
                                      "properties": {
                                        "sslState": "SniEnabled",
                                        "thumbprint": "[parameters('devWebsiteThumbprint')]"
                                      }
                                    }
                                  }
                                }
                              },
                              "dependsOn": [
                                "devManagedCertificate"
                              ]
                            }
                          }
                        }
                      }
                    },
                    "apiWebsiteBindings": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('apiWebsiteBindings-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dnsZoneName": {
                            "value": "[parameters('dnsZoneName')]"
                          },
                          "apiWebsiteHostname": {
                            "value": "[parameters('apiWebsiteHostname')]"
                          },
                          "apiWebsiteLocation": {
                            "value": "[parameters('resourceLocation')]"
                          },
                          "apiWebsiteAppServicePlanId": {
                            "value": "[parameters('devWebsiteAppServicePlanId')]"
                          },
                          "apiWebsiteDeploymentDate": {
                            "value": "[parameters('resourceDeploymentDate')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "16370012161478740269"
                            },
                            "description": "Custom domain binding and managed certificate for api.arolariu.ro",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "definitions": {
                            "resourceTags": {
                              "type": "object",
                              "properties": {
                                "environment": {
                                  "type": "string",
                                  "allowedValues": [
                                    "DEVELOPMENT",
                                    "PRODUCTION"
                                  ],
                                  "metadata": {
                                    "description": "Environment tag"
                                  }
                                },
                                "deploymentType": {
                                  "type": "string",
                                  "allowedValues": [
                                    "ARM",
                                    "Bicep",
                                    "Terraform"
                                  ],
                                  "metadata": {
                                    "description": "Deployment method"
                                  }
                                },
                                "deploymentDate": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment date in YYYY-MM-DD format"
                                  }
                                },
                                "deploymentAuthor": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Deployment author"
                                  }
                                },
                                "module": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Module or service name"
                                  }
                                },
                                "costCenter": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Cost center for billing"
                                  }
                                },
                                "project": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Project name or identifier"
                                  }
                                },
                                "version": {
                                  "type": "string",
                                  "metadata": {
                                    "description": "Version of the deployment"
                                  }
                                }
                              },
                              "metadata": {
                                "description": "Resource tagging configuration",
                                "__bicep_imported_from!": {
                                  "sourceTemplate": "../types/common.type.bicep"
                                }
                              }
                            }
                          },
                          "parameters": {
                            "dnsZoneName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the DNS zone for the custom domain."
                              }
                            },
                            "apiWebsiteHostname": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the App Service to bind the custom domain to."
                              }
                            },
                            "apiWebsiteLocation": {
                              "type": "string",
                              "metadata": {
                                "description": "The location for the resources."
                              }
                            },
                            "apiWebsiteAppServicePlanId": {
                              "type": "string",
                              "metadata": {
                                "description": "The App Service Plan ID."
                              }
                            },
                            "apiWebsiteDeploymentDate": {
                              "type": "string",
                              "metadata": {
                                "description": "The deployment date."
                              }
                            }
                          },
                          "variables": {
                            "commonTags": {
                              "environment": "DEVELOPMENT",
                              "deploymentType": "Bicep",
                              "deploymentDate": "[parameters('apiWebsiteDeploymentDate')]",
                              "deploymentAuthor": "Alexandru-Razvan Olariu",
                              "module": "bindings",
                              "costCenter": "infrastructure",
                              "project": "arolariu.ro",
                              "version": "2.0.0"
                            }
                          },
                          "resources": {
                            "apiWebsite": {
                              "existing": true,
                              "type": "Microsoft.Web/sites",
                              "apiVersion": "2024-11-01",
                              "name": "[parameters('apiWebsiteHostname')]"
                            },
                            "dnsZone": {
                              "existing": true,
                              "type": "Microsoft.Network/dnsZones",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[parameters('dnsZoneName')]"
                            },
                            "apiCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'api')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "[reference('apiWebsite').defaultHostName]"
                                }
                              },
                              "dependsOn": [
                                "apiWebsite"
                              ]
                            },
                            "apiTxtRecord": {
                              "type": "Microsoft.Network/dnsZones/TXT",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'asuid.api')]",
                              "properties": {
                                "TTL": 3600,
                                "TXTRecords": [
                                  {
                                    "value": [
                                      "[reference('apiWebsite').customDomainVerificationId]"
                                    ]
                                  }
                                ]
                              },
                              "dependsOn": [
                                "apiWebsite"
                              ]
                            },
                            "apiCustomDomain": {
                              "type": "Microsoft.Web/sites/hostNameBindings",
                              "apiVersion": "2024-11-01",
                              "name": "[format('{0}/{1}', parameters('apiWebsiteHostname'), 'api.arolariu.ro')]",
                              "properties": {
                                "hostNameType": "Verified",
                                "sslState": "Disabled",
                                "customHostNameDnsRecordType": "CName",
                                "siteName": "[parameters('apiWebsiteHostname')]"
                              },
                              "dependsOn": [
                                "apiCnameRecord",
                                "apiTxtRecord"
                              ]
                            },
                            "apiManagedCertificate": {
                              "type": "Microsoft.Web/certificates",
                              "apiVersion": "2024-11-01",
                              "name": "cert-api-arolariu-ro",
                              "location": "[parameters('apiWebsiteLocation')]",
                              "properties": {
                                "serverFarmId": "[parameters('apiWebsiteAppServicePlanId')]",
                                "canonicalName": "api.arolariu.ro"
                              },
                              "tags": "[union(variables('commonTags'), createObject('displayName', 'Development Managed Certificate', 'resourceType', 'SSL Certificate'))]",
                              "dependsOn": [
                                "apiCustomDomain"
                              ]
                            },
                            "certificateBindings": {
                              "type": "Microsoft.Resources/deployments",
                              "apiVersion": "2022-09-01",
                              "name": "api-arolariu-ro-certificate-bindings",
                              "properties": {
                                "expressionEvaluationOptions": {
                                  "scope": "inner"
                                },
                                "mode": "Incremental",
                                "parameters": {
                                  "apiWebsiteHostname": {
                                    "value": "[parameters('apiWebsiteHostname')]"
                                  },
                                  "apiWebsiteThumbprint": {
                                    "value": "[reference('apiManagedCertificate').thumbprint]"
                                  }
                                },
                                "template": {
                                  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                                  "languageVersion": "2.0",
                                  "contentVersion": "1.0.0.0",
                                  "metadata": {
                                    "_generator": {
                                      "name": "bicep",
                                      "version": "0.36.1.42791",
                                      "templateHash": "6908388708857265006"
                                    },
                                    "description": "Custom domain binding and managed certificate for api.arolariu.ro",
                                    "author": "Alexandru-Razvan Olariu"
                                  },
                                  "parameters": {
                                    "apiWebsiteHostname": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "The name of the App Service to bind the custom domain to."
                                      }
                                    },
                                    "apiWebsiteThumbprint": {
                                      "type": "string",
                                      "metadata": {
                                        "description": "The api website certificate thumbprint for SSL binding."
                                      }
                                    }
                                  },
                                  "resources": {
                                    "apiWebsite": {
                                      "existing": true,
                                      "type": "Microsoft.Web/sites",
                                      "apiVersion": "2024-11-01",
                                      "name": "[parameters('apiWebsiteHostname')]"
                                    },
                                    "apiCustomDomainWithSsl": {
                                      "type": "Microsoft.Web/sites/hostNameBindings",
                                      "apiVersion": "2024-11-01",
                                      "name": "[format('{0}/{1}', parameters('apiWebsiteHostname'), 'api.arolariu.ro')]",
                                      "properties": {
                                        "sslState": "SniEnabled",
                                        "thumbprint": "[parameters('apiWebsiteThumbprint')]"
                                      }
                                    }
                                  }
                                }
                              },
                              "dependsOn": [
                                "apiManagedCertificate"
                              ]
                            }
                          }
                        }
                      }
                    },
                    "docsWebsiteBindings": {
                      "type": "Microsoft.Resources/deployments",
                      "apiVersion": "2022-09-01",
                      "name": "[format('docsWebsiteBindings-{0}', parameters('resourceDeploymentDate'))]",
                      "properties": {
                        "expressionEvaluationOptions": {
                          "scope": "inner"
                        },
                        "mode": "Incremental",
                        "parameters": {
                          "dnsZoneName": {
                            "value": "[parameters('dnsZoneName')]"
                          },
                          "docsWebsiteHostname": {
                            "value": "[parameters('docsWebsiteHostname')]"
                          }
                        },
                        "template": {
                          "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
                          "languageVersion": "2.0",
                          "contentVersion": "1.0.0.0",
                          "metadata": {
                            "_generator": {
                              "name": "bicep",
                              "version": "0.36.1.42791",
                              "templateHash": "16141544776923580779"
                            },
                            "description": "Custom domain binding and managed certificate for docs.arolariu.ro",
                            "author": "Alexandru-Razvan Olariu"
                          },
                          "parameters": {
                            "dnsZoneName": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the DNS zone for the custom domain."
                              }
                            },
                            "docsWebsiteHostname": {
                              "type": "string",
                              "metadata": {
                                "description": "The name of the App Service to bind the custom domain to."
                              }
                            }
                          },
                          "resources": {
                            "docsWebsite": {
                              "existing": true,
                              "type": "Microsoft.Web/staticSites",
                              "apiVersion": "2024-11-01",
                              "name": "[parameters('docsWebsiteHostname')]"
                            },
                            "dnsZone": {
                              "existing": true,
                              "type": "Microsoft.Network/dnsZones",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[parameters('dnsZoneName')]"
                            },
                            "docsCnameRecord": {
                              "type": "Microsoft.Network/dnsZones/CNAME",
                              "apiVersion": "2023-07-01-preview",
                              "name": "[format('{0}/{1}', parameters('dnsZoneName'), 'docs')]",
                              "properties": {
                                "TTL": 3600,
                                "CNAMERecord": {
                                  "cname": "[reference('docsWebsite').defaultHostname]"
                                }
                              },
                              "dependsOn": [
                                "docsWebsite"
                              ]
                            },
                            "docsCustomDomain": {
                              "type": "Microsoft.Web/staticSites/customDomains",
                              "apiVersion": "2024-11-01",
                              "name": "[format('{0}/{1}', parameters('docsWebsiteHostname'), 'docs.arolariu.ro')]",
                              "dependsOn": [
                                "docsCnameRecord"
                              ]
                            }
                          }
                        }
                      }
                    }
                  }
                }
              },
              "dependsOn": [
                "computeDeployment",
                "networkDeployment",
                "websiteDeployment"
              ]
            }
          }
        }
      },
      "dependsOn": [
        "resourceGroup"
      ]
    }
  }
}